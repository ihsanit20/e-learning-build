import{r as u,a2 as O,x as o,y as i,z as e,A as g,M as F,C as m,Q as U,X as C,I as L,D as _,H as z,L as M,Z as N,F as B,G as j,W as S}from"./vue-CAqJJQzZ.js";import{d as $,f as V,j as I}from"./index-CCZtyDAV.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-PJuFQbji.js";const E=["src"],R={class:"bg-white rounded-md p-4 w-96 relative"},A=["src"],H=["disabled"],P={key:0,class:"text-green-600 mt-2"},X={key:1,class:"text-red-600 mt-2"},q={__name:"ThumbnailUploader",props:{bundleId:{type:[Number,String],required:!0},initialThumbnail:{type:String,default:"/default-thumbnail.jpg"}},emits:["uploaded"],setup(h,{emit:f}){const c=h,y=f,v=$(),s=u(c.initialThumbnail),d=u(null),a=u(""),r=u(""),b=u(!1),x=u(!1);O(()=>c.initialThumbnail,p=>{s.value=p});const w=p=>{const l=p.target.files[0];l&&(l.size>2*1024*1024?(a.value="File should be less than 2MB",d.value=null):(d.value=l,a.value="",s.value=URL.createObjectURL(l)))},k=async()=>{if(!d.value)return;const p=new FormData;p.append("thumbnail",d.value),b.value=!0;try{await v.uploadThumbnail(c.bundleId,p),r.value="Thumbnail uploaded successfully!",d.value=null,y("uploaded")}catch(l){a.value=(l==null?void 0:l.message)??"Upload failed"}finally{b.value=!1}},n=()=>{x.value=!0},t=()=>{x.value=!1};return(p,l)=>(i(),o("div",null,[e("img",{class:"aspect-video object-cover rounded-md border overflow-hidden cursor-pointer",src:s.value,alt:"Thumbnail",onClick:n},null,8,E),l[1]||(l[1]=e("p",{class:"text-xs md:text-sm text-center mt-1"},"Click on the image to view or change.",-1)),x.value?(i(),o("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:F(t,["self"])},[e("div",R,[e("button",{onClick:t,class:"absolute top-2 right-2 text-gray-600 hover:text-gray-900 text-xl"}," × "),l[0]||(l[0]=e("h3",{class:"text-lg font-bold mb-2"},"Upload Thumbnail",-1)),e("img",{class:"aspect-video object-cover rounded-md border mb-4 w-full",src:s.value,alt:"Preview"},null,8,A),e("input",{type:"file",onChange:w,class:"input-1 py-1 w-full mb-2",accept:"image/*"},null,32),e("button",{onClick:k,class:"btn-2 w-full",disabled:b.value||!d.value},m(b.value?"Uploading...":"Upload"),9,H),r.value?(i(),o("p",P,m(r.value),1)):g("",!0),a.value?(i(),o("p",X,m(a.value),1)):g("",!0)])])):g("",!0)]))}},G=D(q,[["__scopeId","data-v-80c46c07"]]),Q={key:0,class:"modal"},W={__name:"BundleDeleteModal",props:{isOpen:Boolean,bundle:Object},emits:["close","confirmDelete"],setup(h,{emit:f}){const c=h,y=f,v=$(),s=async()=>{c.bundle&&(await v.deleteBundle(c.bundle.id),y("confirmDelete"),y("close"))},d=()=>{y("close")};return(a,r)=>h.isOpen?(i(),o("div",Q,[e("div",{class:"modal-content card-bg p-4 md:p-8"},[r[0]||(r[0]=e("h2",{class:"title-md text-red-600 text-center"},"Confirm Delete",-1)),r[1]||(r[1]=e("p",{class:"text-center"},"Are you sure you want to delete this bundle?",-1)),e("div",{class:"flex space-x-4 justify-center"},[e("button",{class:"btn-contrast",onClick:s},"Yes"),e("button",{class:"btn-2",onClick:d},"No")])])])):g("",!0)}},Y={key:0,class:"modal"},Z={class:"relative card-bg p-4 md:p-8 max-w-3xl h-2/3"},J={class:"overflow-y-scroll scrollbar space-y-2 p-2 bg-gray-100 rounded-md"},K=["src"],ee={class:"flex w-full text-center gap-4"},te={class:"text-center text-green-600"},le={class:"text-center text-red-600"},se={class:"title-md"},ne={class:"md:flex justify-between"},ae=["innerHTML"],oe={key:0},ie={class:"font-bold text-sky-600"},de={class:""},ue={class:"title-sm"},ce={__name:"BundleViewModal",props:{bundle:Object,isOpen:Boolean},emits:["close"],setup(h,{emit:f}){const c=h,y=$(),v=f,s=U(()=>y.bundles.find(n=>n.id===c.bundle.id)),d=()=>{v("close")},a=u(null),r=u(""),b=u(""),x=n=>{const t=n.target.files[0];t&&t.size>2*1024*1024?(b.value="File should be less than 2MB",a.value=null,document.getElementById("file-input").value=""):(a.value=t,b.value="")},w=async()=>{if(!a.value)return;const n=new FormData;n.append("thumbnail",a.value);try{await y.uploadThumbnail(c.bundle.id,n),r.value="Thumbnail uploaded successfully!",a.value=null,document.getElementById("file-input").value=""}catch{b.value="An error occurred while uploading the thumbnail"}},k=n=>V(new Date(n),"dd-MMM-yyyy");return(n,t)=>{var p,l;return h.isOpen?(i(),o("div",Y,[e("div",Z,[e("div",{class:"flex top-2 right-2 z-50 absolute"},[e("button",{class:"bg-red-500 px-2 rounded-full text-white",onClick:d},"X")]),e("div",J,[e("img",{class:"aspect-video object-cover rounded-lg",src:s.value.thumbnail,alt:"Thumbnail"},null,8,K),t[5]||(t[5]=e("p",{class:"text-sm"}," **File size should be less than 2MB and aspect ratio 9:16 (720px x 1280px)** ",-1)),e("div",ee,[e("input",{id:"file-input",type:"file",onChange:x,class:"input-1"},null,32),e("button",{class:"btn-1",onClick:w},"Upload")]),e("p",te,m(r.value),1),e("p",le,m(b.value),1),e("h2",se,m(s.value.title),1),e("div",ne,[e("p",null,[t[0]||(t[0]=C(" Bundle Category: ")),e("b",null,m((l=(p=s.value)==null?void 0:p.category)==null?void 0:l.name),1)]),e("p",null,[t[1]||(t[1]=C(" Bundle Type: ")),e("b",null,m(s.value.bundle_type),1)])]),e("div",null,[t[2]||(t[2]=e("b",null,"Bundle Description:",-1)),e("div",{innerHTML:s.value.description,class:""},null,8,ae)]),s.value.bundle_type==="Live Bundle"?(i(),o("p",oe,[t[3]||(t[3]=C(" Start Date: ")),e("span",ie,m(k(s.value.start_date)),1)])):g("",!0),e("p",de,[t[4]||(t[4]=C(" Price: ৳ ")),e("span",ue,m(s.value.price),1)])]),e("div",null,[e("button",{class:"btn-contrast",onClick:d},"Close")])])])):g("",!0)}}},re=D(ce,[["__scopeId","data-v-1f060b29"]]),pe={class:"my-container space-y-2 relative"},me={class:"flex justify-between items-center"},ve={key:0,class:"space-y-2"},be={key:1},fe={key:0,class:"text-center"},ye={key:1,class:"space-y-2"},ge={key:0,class:"card-bg md:py-4 p-4 md:p-2 grid md:grid-cols-3 lg:grid-cols-4 md:divide-x-2"},he={class:"md:col-span-1 px-2 content-center"},xe={class:"md:col-span-2 lg:col-span-3 md:px-4 space-y-2 flex flex-col justify-between"},_e={class:"flex justify-start items-center w-full gap-3"},we={class:"shrink-0 text-xl font-semibold size-9 flex justify-center items-center border pt-1 rounded-xl"},ke={class:"title-md"},Ce={class:"flex flex-wrap gap-4 items-center justify-between"},$e={class:"flex justify-start items-center gap-2"},Be={class:"flex justify-end items-center gap-2"},Me=["onClick"],je=["onClick"],Ue={__name:"BundleList",setup(h){const f=$(),c=u([]),y=u(!1),v=u(null),s=u(!1),d=u(!1),a=u(!0),r=async()=>{a.value=!0,await f.fetchBundles(),c.value=f.bundles.sort((n,t)=>t.id-n.id),a.value=!1};L(async()=>{await r()});const b=n=>{v.value=n,s.value=!0},x=n=>{v.value=n,d.value=!0},w=async()=>{await f.deleteBundle(v.value.id),c.value=f.bundles},k=()=>{alert("Thumbnail successfully uploaded!")};return(n,t)=>{const p=N("RouterLink");return i(),o("div",pe,[e("div",me,[t[6]||(t[6]=e("h1",{class:"title-lg text-center"},"Bundles",-1)),e("div",{onClick:r,class:"bg-white border flex justify-center items-center gap-2 btn-4 cursor-pointer"},[e("i",{class:z(["fas fa-sync text-lg",{"animate-spin":a.value}])},null,2),t[3]||(t[3]=e("span",{class:"pt-1 hidden md:inline"},"Reload",-1))]),g("",!0),_(p,{class:"btn-2",to:{name:"NewBundle"}},{default:M(()=>t[5]||(t[5]=[C("Add New")])),_:1})]),a.value?(i(),o("div",ve,[(i(),o(B,null,j(3,l=>e("div",{key:l,class:"card-bg md:py-2 p-4 md:p-2 grid md:grid-cols-8 md:divide-x-2 animate-pulse"},t[7]||(t[7]=[S('<div class="md:col-span-1 rounded md:px-2"><div class="aspect-video bg-gray-200"></div></div><div class="md:col-span-3 md:px-2"><div class="h-6 bg-gray-200 rounded-full mb-2"></div><div class="h-4 bg-gray-200 rounded-full"></div></div><div class="md:col-span-1 flex items-center justify-center px-2"><div class="h-6 bg-gray-200 rounded-full w-20"></div></div><div class="md:col-span-3 flex justify-between items-center gap-2 md:px-2"><div class="h-10 bg-gray-200 rounded-full w-20"></div><div class="h-10 bg-gray-200 rounded-full w-20"></div><div class="h-10 bg-gray-200 rounded-full w-20"></div><div class="h-10 bg-gray-200 rounded-full w-20"></div></div>',4)]))),64))])):(i(),o("div",be,[c.value.length===0?(i(),o("div",fe,t[8]||(t[8]=[e("p",null,"No bundles available.",-1)]))):(i(),o("ul",ye,[(i(!0),o(B,null,j(c.value,l=>(i(),o(B,{key:l.id},[!y.value||l.is_active?(i(),o("li",ge,[e("div",he,[_(G,{"bundle-id":l.id,"initial-thumbnail":l.thumbnail,onUploaded:k},null,8,["bundle-id","initial-thumbnail"])]),e("div",xe,[e("div",_e,[e("span",we,m(l.id),1),e("h2",ke,m(l.title),1)]),_(I,{bundle:l},null,8,["bundle"]),e("div",Ce,[e("div",$e,[g("",!0)]),e("div",Be,[e("button",{class:"btn-1 pb-1 pt-1.5 px-3",onClick:T=>b(l)},t[9]||(t[9]=[e("i",{class:"fas fa-eye"},null,-1),e("p",{class:"hidden md:flex"},"View",-1)]),8,Me),_(p,{to:{name:"BundleEditForm",params:{id:l.id}},class:"btn-1 pb-1 pt-1.5 px-3"},{default:M(()=>t[10]||(t[10]=[e("i",{class:"far fa-edit"},null,-1),e("p",{class:"hidden md:flex"},"Edit",-1)])),_:2},1032,["to"]),(i(),o("button",{key:0,class:"btn-contrast pb-2",onClick:T=>x(l)},t[11]||(t[11]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,je))])])])])):g("",!0)],64))),128))]))])),_(re,{class:"absolute top-0 shadow-2xl w-full z-40",bundle:v.value,isOpen:s.value,onClose:t[1]||(t[1]=l=>s.value=!1)},null,8,["bundle","isOpen"]),_(W,{class:"absolute top-0 shadow-2xl w-full z-40",bundle:v.value,isOpen:d.value,onClose:t[2]||(t[2]=l=>d.value=!1),onConfirmDelete:w},null,8,["bundle","isOpen"])])}}};export{Ue as default};
