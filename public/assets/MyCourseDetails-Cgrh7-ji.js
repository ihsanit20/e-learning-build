import{r as m,x as l,y as s,z as e,a4 as V,C as c,O as h,A as p,X as L,d as K,P as Q,I as W,T as Z,ad as ee,F as b,G as j,M as k,U as te,ab as se,H as w,L as $,D as R,B,S as le}from"./vue-CcEtAIOs.js";import{_ as oe,a as ae}from"./MeritPosition-B4KpAoFb.js";import{_ as z}from"./TimeCountdown-BJrA84f-.js";import{u as ne}from"./course-exam-Dt2ct5hs.js";import{h as J,u as ie,c as re}from"./index-Dvq6w91M.js";import"./vendor-PJuFQbji.js";const de={class:"modal"},ce={class:"modal-content !px-3 !py-4 !max-w-sm"},ue={class:"w-full h-full flex flex-col justify-between items-center space-y-3 overflow-hidden"},me={class:"w-full flex justify-between items-center"},pe={class:"title-lg text-center"},fe={class:"size-full grow shrink border-t py-4 overflow-y-auto scrollbar flex flex-col gap-4 justify-center items-center"},xe={class:"w-full flex justify-between items-center"},ve={__name:"ExamResultModal",props:{selectedExam:Object},setup(n){const d=m(!1);return(u,o)=>{var f;return s(),l("div",de,[e("div",ce,[e("div",ue,[e("div",me,[e("h3",pe,"Result of "+c(n.selectedExam.title),1),V(u.$slots,"default")]),e("div",fe,[n.selectedExam?(s(),h(oe,{key:0,selectedExam:n.selectedExam},null,8,["selectedExam"])):p("",!0),o[1]||(o[1]=e("hr",{class:"w-full"},null,-1)),e("div",xe,[d.value?V(u.$slots,"answerSheet",{key:0}):(f=n.selectedExam)!=null&&f.result_publish_time?(s(),h(z,{key:1,modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=C=>d.value=C),targetTime:n.selectedExam.result_publish_time,label:"Results are not yet published",class:"mx-auto items-center"},null,8,["modelValue","targetTime"])):p("",!0)])])])])])}}},ye={class:"flex items-center gap-4 bg-gray-100 hover:bg-sky-100 p-2 rounded-md"},_e={class:"w-full"},he={class:"title-sm"},ge={key:0,class:"fas fa-check-circle text-green-700"},be={class:"flex justify-between gap-2 text-sm text-gray-400"},ke={class:"flex items-center gap-2"},we={__name:"ModuleItemExam",props:{exam:Object},setup(n){const d=m(!1);return(u,o)=>(s(),l("div",ye,[o[3]||(o[3]=e("div",{class:"flex flex-col items-center justify-center border rounded-md p-2 gap-1"},[e("i",{class:"fas fa-file-alt"}),e("div",{class:"text-xs"},"Exam")],-1)),e("div",_e,[e("h4",he,[n.exam.is_completed?(s(),l("i",ge)):p("",!0),L(" "+c(n.exam.title),1)]),e("div",be,[e("div",ke,[o[2]||(o[2]=e("i",{class:"far fa-clock"},null,-1)),e("p",null,[o[1]||(o[1]=e("span",null,"Duration:",-1)),L(" "+c(n.exam.duration),1)])])])]),d.value||n.exam.is_completed?V(u.$slots,"default",{key:0}):(s(),h(z,{key:1,modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=f=>d.value=f),targetTime:n.exam.opening_time},null,8,["modelValue","targetTime"]))]))}},$e={class:"flex items-center gap-4 bg-gray-100 hover:bg-sky-100 p-2 rounded-md"},Ce={class:"w-full"},Ee={class:"title-sm"},Se={class:"flex justify-between gap-2 text-sm text-gray-400"},Me={class:"flex items-center gap-2"},je={__name:"ModuleItemMaterial",props:{material:Object},setup(n){const d=m(!1);return(u,o)=>(s(),l("div",$e,[o[1]||(o[1]=e("div",{class:"flex flex-col items-center justify-center border rounded-md p-2 gap-1"},[e("i",{class:"fas fa-download"}),e("div",{class:"text-xs"},"Material")],-1)),e("div",Ce,[e("h4",Ee,c(n.material.title),1),e("div",Se,[e("div",Me,[e("p",null,c(n.material.description),1)])])]),d.value?V(u.$slots,"default",{key:0}):(s(),h(z,{key:1,modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=f=>d.value=f),targetTime:n.material.opening_time},null,8,["modelValue","targetTime"]))]))}},Ve=K("courseProgress",{state:()=>({userId:null}),actions:{async completeLecture(n,d,u){try{return(await J.post(`/lectures/${d}/complete`,{course_id:n,is_completed:u})).data}catch(o){throw console.error("Error completing lecture:",o),o}},async getLectureCompletionStatus(n,d){try{return(await J.get(`/users/${n}/lectures/${d}/completion`)).data.is_completed}catch(u){throw console.error("Error fetching lecture completion status:",u),u}},setUserId(n){this.userId=n}}}),Le={class:"my-container py-4"},Ie={key:0,class:"error"},Pe={key:1,class:"grid md:grid-cols-3 gap-4"},Oe={class:"md:col-span-2 space-y-4"},Te={class:"title-xl"},Re={class:"relative pt-1"},ze={class:"flex mb-2 items-center justify-between"},De={class:"text-right"},Ne={class:"text-xs font-semibold inline-block text-sky-600"},Ae={class:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-sky-200"},Ue={class:"flex items-center gap-4 justify-between"},Be=["href"],Je={class:"space-y-4"},qe=["onClick"],Fe={class:"text-center border-2 rounded-md p-1.5"},Ge={class:"flex-1"},He={class:"line-clamp-1"},Xe={key:0},Ye={class:""},Ke={class:"flex items-center gap-4 bg-gray-100 hover:bg-sky-100 p-2 rounded-md"},Qe={class:"flex flex-col items-center justify-center border rounded-md p-2 gap-1"},We={class:"text-xs"},Ze={key:0},et={key:1},tt={class:"flex-1"},st={key:0,class:"fas fa-check-circle text-green-700"},lt={class:"text-gray-500 text-xs line-clamp-1"},ot=["onClick"],at={class:"flex items-center text-sm pt-2"},nt=["id","checked","onChange","disabled"],it=["for"],rt=["href"],dt={key:0,class:"animate-pulse"},ct=["onClick"],ut={key:2},mt={key:3,class:"fixed inset-0 flex items-center justify-center z-50"},pt={class:"card-bg items-center justify-center p-6 md:p-8 overflow-hidden transform transition-all sm:max-w-lg sm:w-full text-center mx-2"},ft={class:""},xt={class:"text-red-500"},vt={class:"flex gap-4"},yt={class:"modal-content !px-3 !py-4 !max-w-xl"},_t={class:"w-full h-full flex flex-col justify-between items-center space-y-3 overflow-hidden"},ht={class:"size-full grow shrink border-y py-4 overflow-y-auto scrollbar"},gt={class:"w-full list-[square] space-y-3 list-outside pl-5"},bt={class:"flex items-center gap-1 md:gap-2"},kt={class:"w-full flex justify-between gap-2"},jt={__name:"MyCourseDetails",setup(n){const d=Q(),u=Z(),o=ie(),f=ne(),C=Ve(),D=re(),x=d.params.id,v=m(null),I=m(null),_=m(JSON.parse(localStorage.getItem(`openModules_${x}`))||[]),E=m(!1),S=m(!1),M=m(!1),g=m(null),y=m(null),P=m(!1),O=m(null),T=async()=>{await o.fetchPurchasedCourse(x),v.value=o.course};W(async()=>{try{await T()}catch(i){I.value=i.message||"An error occurred",i.response&&i.response.status===403&&u.push("/")}});const q=i=>{const t=_.value.indexOf(i);t===-1?_.value.push(i):_.value.splice(t,1),localStorage.setItem(`openModules_${x}`,JSON.stringify(_.value))},F=i=>{i.type==="video"?(D.endedCallback=async()=>{const t=await C.completeLecture(x,i.id,!0);i.is_completed=t.is_completed,await T()},D.showPlayer(i.link)):window.open(i.link,"_blank")},G=async i=>{if(!i.is_completed){y.value=i,S.value=!0;return}return O.value=i.id,y.value=await f.fetchExam(x,i.id),O.value=null,M.value=!0},H=async()=>{if(g.value)try{await C.completeLecture(x,g.value.id,!0),g.value.is_completed=!0,E.value=!1,await T()}catch(i){console.error("Error confirming lecture completion:",i)}},X=i=>{g.value=i,E.value=!0},Y=async()=>{u.push({path:`/my/course/${x}/exam/${y.value.id}`})};return(i,t)=>{var N,A;return s(),l(b,null,[e("div",Le,[I.value?(s(),l("div",Ie,c(I.value),1)):v.value?(s(),l("div",Pe,[e("div",Oe,[e("div",null,[e("h1",Te,c(v.value.title),1),t[7]||(t[7]=e("hr",{class:"my-2"},null,-1))]),e("div",null,[e("div",Re,[e("div",ze,[t[8]||(t[8]=e("div",null,[e("span",null,"Course Progress")],-1)),e("div",De,[e("span",Ne,c(v.value.progress)+"% ",1)])]),e("div",Ae,[e("div",{style:ee({width:v.value.progress+"%"}),class:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-sky-600"},null,4)])])]),e("div",Ue,[t[10]||(t[10]=e("h2",{class:"title-lg -mb-1"},"Modules",-1)),v.value.facebook_group_link?(s(),l("a",{key:0,href:v.value.facebook_group_link,target:"_blank",class:"ml-auto btn-2 px-4 hover:text-white",onClick:t[0]||(t[0]=r=>r.stopPropagation())},t[9]||(t[9]=[e("i",{class:"fab fa-facebook text-lg"},null,-1),e("span",{class:"-mb-1 scale-110 ml-0.5"},"Group",-1)]),8,Be)):p("",!0)]),e("ul",Je,[(s(!0),l(b,null,j(v.value.modules,r=>(s(),l("li",{class:"card-bg p-4",key:r.id},[e("div",{onClick:a=>q(r.id),class:"flex flex-1 items-center gap-4 cursor-pointer"},[e("div",Fe,[e("div",{class:w(["text-xl font-bold text-orange-500",{"!text-gray-400":r.is_active==0}])},c(r.order),3),t[11]||(t[11]=e("div",{class:"text-xs md:text-sm"},"Module",-1))]),e("div",Ge,[e("h4",{class:w(["title-md",{"text-gray-400":r.is_active==0}])},c(r.title),3),e("p",He,c(r.description),1)]),e("button",null,[e("i",{class:w(_.value.includes(r.id)?"fas fa-angle-up":"fas fa-angle-down")},null,2)])],8,qe),_.value.includes(r.id)?(s(),l("div",Xe,[e("ul",Ye,[(s(!0),l(b,null,j(r.lectures,a=>(s(),l("li",{class:"pt-6",key:a.id},[e("div",Ke,[e("div",Qe,[e("i",{class:w(a.type==="virtual_platform"?"fas fa-video":"fas fa-play-circle")},null,2),e("div",We,[a.type==="virtual_platform"?(s(),l("p",Ze,"Video")):(s(),l("p",et,"Lecture"))])]),e("div",tt,[e("h4",null,[a.is_completed?(s(),l("i",st)):p("",!0),L(" "+c(a.title),1)]),e("p",lt,c(a.description),1)]),e("button",{onClick:k(U=>F(a),["prevent"]),type:"button",class:"btn-2"},c(a.type==="video"?"Play Video":"Join Live"),9,ot)]),e("div",at,[e("input",{type:"checkbox",id:`completed-${a.id}`,class:"form-checkbox h-3 w-3 text-sky-600 transition duration-150 ease-in-out",checked:a.is_completed,onChange:U=>X(a),disabled:a.is_completed},null,40,nt),e("label",{for:`completed-${a.id}`,class:"ml-2"}," Have you completed this lecture? ",8,it)])]))),128)),(s(!0),l(b,null,j(r.materials,a=>(s(),l("li",{class:"pt-6",key:a.id},[R(je,{material:a},{default:$(()=>[a.download_link?(s(),l("a",{key:0,href:a.download_link,class:"btn-2",download:""}," Download ",8,rt)):p("",!0)]),_:2},1032,["material"])]))),128)),(s(!0),l(b,null,j(r.exams,a=>(s(),l("li",{class:"pt-6",key:a.id},[R(we,{exam:a},{default:$(()=>[O.value===a.id?(s(),l("span",dt,"Loading...")):(s(),l("button",{key:1,onClick:k(U=>G(a),["prevent"]),type:"button",class:"btn-2"},c(a.is_completed?"result":"Open"),9,ct))]),_:2},1032,["exam"])]))),128))])])):p("",!0)]))),128))])])])):(s(),l("div",ut,"Loading...")),E.value?(s(),l("div",mt,[t[13]||(t[13]=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75"},null,-1)),e("div",pt,[t[12]||(t[12]=e("h3",{class:"title-lg",id:"modal-title"},"Confirm Lecture Completion",-1)),e("div",ft,[e("p",xt,' Are you sure you have completed the lecture "'+c((N=g.value)==null?void 0:N.title)+'"? ',1)]),e("div",vt,[e("button",{onClick:H,type:"button",class:"btn-2"},"Yes"),e("button",{onClick:t[1]||(t[1]=r=>E.value=!1),type:"button",class:"btn-3"},"No")])])])):p("",!0)]),S.value?(s(),l("div",{key:0,class:"modal",onClick:t[4]||(t[4]=k(r=>S.value=!1,["self"]))},[e("div",yt,[e("div",_t,[t[17]||(t[17]=e("div",{class:"sticky top-0 grow-0 shrink-0 w-full bg-white z-10"},[e("h3",{class:"title-lg text-center",id:"modal-title"},"সাবধান!! গুরুত্বপূর্ণ তথ্য সমূহ")],-1)),e("div",ht,[e("ul",gt,[e("li",null," Exam এর সময়সীমা থাকবে "+c((A=y.value)==null?void 0:A.duration)+" মিনিট। এই সময়ের মধ্যে আপনাকে Exam সাবমিট করতে হবে। ",1),t[14]||(t[14]=e("li",null," Exam ওপেন করা (“Start Exam” বাটনে ক্লিক) মাত্র আপনার টাইমার চালু হয়ে যাবে। আপনি Exam থেকে বেরিয়ে গেলেও টাইমার চলতে থাকবে এবং টাইম শেষে সাবমিট করতে হবে। ",-1)),t[15]||(t[15]=e("li",null," Exam দেয়ার সময়ে যদি কোনো কারনে কানেকশন লস হয়ে যায় এবং আপনার টাইম শেষ হয়ে যায় আর সাবমিট করতে না পারেন, তাহলে আর Exam দেয়ার সুযোগ পাবেন না। ",-1))])]),e("form",{onSubmit:k(Y,["prevent"]),class:"grow-0 shrink-0 w-full flex justify-end gap-1 md:gap-4"},[e("button",{onClick:t[2]||(t[2]=r=>S.value=!1),type:"button",class:"mr-auto btn-contrast px-1 md:px-4 text-xs md:text-base"}," Cancel "),e("label",bt,[te(e("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>P.value=r),type:"checkbox",required:""},null,512),[[se,P.value]]),t[16]||(t[16]=e("span",{class:"pt-1 text-xs md:text-base"},"আমি পরীক্ষা শুরু করতে চাই",-1))]),e("button",{type:"submit",class:w(["btn-2 disabled:opacity-50 px-1 md:px-4 text-xs md:text-base",{"opacity-50":!P.value}])}," Start Exam ",2)],32)])])])):p("",!0),M.value?(s(),h(ve,{key:1,selectedExam:y.value,class:"modal",onClick:t[6]||(t[6]=k(r=>M.value=!1,["self"]))},{answerSheet:$(()=>[e("div",kt,[y.value?(s(),h(ae,{key:0,exam:y.value},null,8,["exam"])):p("",!0),R(B(le),{to:{name:"My Exam AnswerSheet",params:{courseId:B(x),examId:y.value.id}},class:"btn-2 px-2 text-center ml-auto"},{default:$(()=>t[18]||(t[18]=[L(" Answer Sheet ")])),_:1},8,["to"])])]),default:$(()=>[e("button",{onClick:t[5]||(t[5]=r=>M.value=!1),type:"button",class:"btn-contrast"},"Close")]),_:1},8,["selectedExam"])):p("",!0)],64)}}};export{jt as default};
