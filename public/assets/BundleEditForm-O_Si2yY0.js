import{P as A,r as i,Q as d,I as D,x as v,z as e,A as k,H as c,C as u,M as F,U as x,a9 as B,F as z,G as H,T as K,y as m,X as V}from"./vue-CcEtAIOs.js";import{u as R}from"./bundle-GV0SUa4l.js";import{u as j}from"./index-B8R8XCyq.js";/* empty css                                                   */import"./vendor-PJuFQbji.js";const q={class:"my-container"},G={class:"card-bg p-4 md:p-8"},L={class:"flex flex-wrap justify-between mb-4"},Q={class:"flex items-center flex-wrap gap-2 text-sm mb-4"},X={class:"border p-4 rounded-md grid sm:grid-cols-2 lg:grid-cols-3 gap-4"},$={class:"border p-4 rounded-md grid grid-cols-2 gap-2 items-center"},J={class:"flex items-start gap-2"},O=["onClick"],W={class:"space-x-1"},Y={class:"shrink-0 grow-0"},Z={class:"block"},ee=["onUpdate:modelValue"],se=["disabled"],te={key:0,class:"message"},ie={__name:"BundleEditForm",setup(oe){const T=A(),S=K(),_=R(),b=j(),w=T.params.id,n=i(""),C=i(""),o=i([]),f=i(""),p=i(""),M=async()=>{await _.fetchBundle(w);const s=_.bundle;s&&(n.value=s.title,C.value=s.description,o.value=s.bundle_courses.map(t=>({course_id:t.course_id,course_price:t.course_price??""})))},P=d(()=>b.courses.filter(s=>o.value.some(t=>parseInt(t.course_id)===parseInt(s.id))));function U(){var a;const s=parseInt(p.value);if(!s)return;const t=o.value.some(r=>parseInt(r.course_id)===s),l=(a=b.courses)==null?void 0:a.some(r=>parseInt(r.id)===s);!t&&l&&o.value.push({course_id:s,course_price:""}),p.value=""}function E(s){confirm("Are you sure to remove this course?")&&o.value.splice(s,1)}const N=async()=>{const s={title:n.value,description:C.value,bundle_courses:o.value};try{await _.updateBundle(w,s),f.value="Bundle updated successfully!",S.push("/management/bundle-list")}catch(t){console.error(t)}},g=d(()=>!!n.value),h=d(()=>o.value.length>=2),y=d(()=>o.value.length>=2&&o.value.every(s=>s.course_price!==""&&Number(s.course_price)>=0)),I=d(()=>g.value&&h.value&&y.value);return D(async()=>{await b.fetchCourses({price:"paid",status:"active",publish:"published"}),await M()}),(s,t)=>(m(),v("div",q,[e("div",G,[e("div",L,[t[3]||(t[3]=e("h1",{class:"title-lg"},"Edit Bundle",-1)),e("div",Q,[e("div",{class:c(g.value?"text-green-600":"text-gray-600")},u(g.value?"✅":"-")+" Bundle Title ",3),e("div",{class:c(h.value?"text-green-600":"text-gray-600")},u(h.value?"✅":"-")+" Minimum 2 courses ",3),e("div",{class:c(y.value?"text-green-600":"text-gray-600")},u(y.value?"✅":"-")+" Bundle Price ",3)])]),e("form",{onSubmit:F(N,["prevent"]),class:"space-y-4"},[x(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>n.value=l),placeholder:"Bundle Title",class:"input-1 w-full"},null,512),[[B,n.value]]),k("",!0),e("div",X,[e("div",$,[x(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>p.value=l),class:"input-1 text-center pb-1.5",placeholder:"Course ID"},null,512),[[B,p.value]]),e("button",{onClick:U,type:"button",class:"btn-1 py-2"},"+ Add")]),(m(!0),v(z,null,H(P.value,(l,a)=>(m(),v("div",{key:l.id,class:c(["border p-4 rounded-md space-y-2 text-center relative",{"col-start-1":!a}])},[e("div",J,[e("i",{onClick:r=>E(a),class:"shrink-0 grow-0 fa fa-trash text-red-600 cursor-pointer"},null,8,O),e("div",W,[e("b",Y,u(l.id)+".",1),e("i",null,u(l.title),1)])]),e("div",null,"Course Price: "+u(l.price)+" TK",1),e("label",Z,[t[4]||(t[4]=V(" Bundle Price ")),x(e("input",{type:"number","onUpdate:modelValue":r=>o.value[a].course_price=r,class:"input-1 max-w-24 py-1",min:"0",required:""},null,8,ee),[[B,o.value[a].course_price]]),t[5]||(t[5]=V(" TK "))])],2))),128))]),e("button",{type:"submit",class:c(["btn-2",{"opacity-50 cursor-not-allowed":!I.value}]),disabled:!I.value}," Save Bundle ",10,se)],32),f.value?(m(),v("p",te,u(f.value),1)):k("",!0)])]))}};export{ie as default};
