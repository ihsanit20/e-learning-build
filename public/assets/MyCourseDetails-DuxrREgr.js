import{E as F,G as E,b as H,c as R,k as U,u as q,l as G,r as m,o as O,d as b,e as o,f as l,t as r,g as e,H as T,F as w,h as C,p as P,n as y,x as I,q as Y}from"./index-4Z-6rGXL.js";const J=F("courseProgress",{state:()=>({userId:null}),actions:{async completeLecture(u,_,a){try{return(await E.post(`/lectures/${_}/complete`,{course_id:u,is_completed:a})).data}catch(p){throw console.error("Error completing lecture:",p),p}},async getLectureCompletionStatus(u,_){try{return(await E.get(`/users/${u}/lectures/${_}/completion`)).data.is_completed}catch(a){throw console.error("Error fetching lecture completion status:",a),a}},setUserId(u){this.userId=u}}}),K={class:"my-container py-4"},Q={key:0,class:"error"},W={key:1,class:"grid md:grid-cols-3 gap-4"},X={class:"md:col-span-2 space-y-4"},Z={class:"title-xl"},ee=e("hr",{class:"my-2"},null,-1),se={class:"relative pt-1"},te={class:"flex mb-2 items-center justify-between"},oe=e("div",null,[e("span",null,"Course Progress")],-1),le={class:"text-right"},ce={class:"text-xs font-semibold inline-block text-sky-600"},ne={class:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-sky-200"},re=e("h2",{class:"title-lg"},"Modules",-1),ie={class:"space-y-4"},ae=["onClick"],de={class:"text-center border-2 rounded-md p-1.5"},ue=e("div",{class:"text-xs md:text-sm"},"Module",-1),_e={class:"flex-1"},pe={class:"line-clamp-1"},he={key:0},ve={class:""},fe=["onClick"],me={class:"flex flex-col items-center justify-center border rounded-md p-2 gap-1"},xe={class:"text-xs"},ye={key:0},ge={key:1},ke={class:"flex-1"},be={class:"text-gray-500 text-xs line-clamp-1"},we={class:"flex items-center text-sm pt-2"},Ce=["id","checked","onChange","disabled"],Le=["for"],Se=["onClick"],Me=e("div",{class:"flex flex-col items-center justify-center border rounded-md p-2 gap-1"},[e("i",{class:"fas fa-file-alt"}),e("div",{class:"text-xs"},"Exam")],-1),$e={class:"w-full"},je={class:"title-sm"},Ee={class:"flex justify-between gap-2 text-sm text-gray-400"},Pe={class:"flex items-center gap-2"},Ie=e("i",{class:"far fa-clock"},null,-1),Ne=e("span",null,"Duration:",-1),Ve={key:2},ze={key:3,class:"fixed inset-0 flex items-center justify-center z-50"},Ae=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75"},null,-1),Be={class:"card-bg items-center justify-center p-6 md:p-8 overflow-hidden transform transition-all sm:max-w-lg sm:w-full text-center mx-2"},De=e("h3",{class:"title-lg",id:"modal-title"},"Confirm Lecture Completion",-1),Fe={class:""},He={class:"text-red-500"},Re={class:"flex gap-4"},qe={__name:"MyCourseDetails",setup(u){const _=H(),a=R(),p=U(),L=q(),h=J(),S=G(),g=_.params.id,i=m(null),k=m(null),v=m([]),x=m(!1),f=m(null);O(async()=>{try{await L.fetchPurchasedCourse(g),i.value=L.course;const s=p.user.id;h.userId||h.setUserId(s);for(const c of i.value.modules)for(const d of c.lectures)d.is_completed=await h.getLectureCompletionStatus(s,d.id)}catch(s){k.value=s.message||"An error occurred",s.response&&s.response.status===403&&a.push("/")}});const N=s=>{const c=v.value.indexOf(s);c===-1?v.value.push(s):v.value.splice(c,1)},V=s=>{s.type==="video"?(S.endedCallback=async()=>{const c=await h.completeLecture(g,s.id,!0);s.is_completed=c.is_completed},S.showPlayer(s.link)):window.open(s.link,"_blank")},z=s=>(console.log(s),alert(" coming soon..!")),A=async()=>{if(f.value)try{await h.completeLecture(g,f.value.id,!0),f.value.is_completed=!0,x.value=!1}catch(s){console.error("Error confirming lecture completion:",s)}},B=s=>{f.value=s,x.value=!0},M=b(()=>i.value?i.value.modules.reduce((s,c)=>s+c.lectures.length,0):0),D=b(()=>i.value?i.value.modules.reduce((s,c)=>s+c.lectures.filter(d=>d.is_completed).length,0):0),$=b(()=>M.value?D.value/M.value*100:0);return(s,c)=>{var d;return o(),l("div",K,[k.value?(o(),l("div",Q,r(k.value),1)):i.value?(o(),l("div",W,[e("div",X,[e("div",null,[e("h1",Z,r(i.value.title),1),ee]),e("div",null,[e("div",se,[e("div",te,[oe,e("div",le,[e("span",ce,r(Math.round($.value))+"% ",1)])]),e("div",ne,[e("div",{style:T({width:$.value+"%"}),class:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-sky-600"},null,4)])])]),re,e("ul",ie,[(o(!0),l(w,null,C(i.value.modules,n=>(o(),l("li",{class:"card-bg p-4",key:n.id},[e("div",{onClick:t=>N(n.id),class:"flex flex-1 items-center gap-4 cursor-pointer"},[e("div",de,[e("div",{class:y(["text-xl font-bold text-orange-500",{"!text-gray-400":n.is_active==0}])},r(n.order),3),ue]),e("div",_e,[e("h4",{class:y(["title-md",{"text-gray-400":n.is_active==0}])},r(n.title),3),e("p",pe,r(n.description),1)]),e("button",null,[e("i",{class:y(v.value.includes(n.id)?"fas fa-angle-up":"fas fa-angle-down")},null,2)])],8,ae),v.value.includes(n.id)?(o(),l("div",he,[e("ul",ve,[(o(!0),l(w,null,C(n.lectures,t=>(o(),l("li",{class:"pt-6",key:t.id},[e("a",{onClick:I(j=>V(t),["prevent"]),class:"flex items-center gap-4 bg-gray-100 hover:bg-sky-100 p-2 rounded-md cursor-pointer"},[e("div",me,[e("i",{class:y(t.type==="virtual_platform"?"fas fa-video":"fas fa-play-circle")},null,2),e("div",xe,[t.type==="virtual_platform"?(o(),l("p",ye,"Video")):(o(),l("p",ge,"Lecture"))])]),e("div",ke,[e("h4",null,r(t.title),1),e("p",be,r(t.description),1)])],8,fe),e("div",we,[e("input",{type:"checkbox",id:`completed-${t.id}`,class:"form-checkbox h-3 w-3 text-sky-600 transition duration-150 ease-in-out",checked:t.is_completed,onChange:j=>B(t),disabled:t.is_completed},null,40,Ce),e("label",{for:`completed-${t.id}`,class:"ml-2"}," Have you completed this lecture? ",8,Le)])]))),128)),(o(!0),l(w,null,C(n.exams,t=>(o(),l("li",{class:"pt-6",key:t.id},[e("a",{onClick:I(j=>z(t),["prevent"]),class:"flex items-center gap-4 bg-gray-100 hover:bg-sky-100 p-2 rounded-md cursor-pointer"},[Me,e("div",$e,[e("h4",je,r(t.title),1),e("div",Ee,[e("div",Pe,[Ie,e("p",null,[Ne,Y(" "+r(t.duration),1)])])])])],8,Se)]))),128))])])):P("",!0)]))),128))])])])):(o(),l("div",Ve,"Loading...")),x.value?(o(),l("div",ze,[Ae,e("div",Be,[De,e("div",Fe,[e("p",He,' Are you sure you have completed the lecture "'+r((d=f.value)==null?void 0:d.title)+'"? ',1)]),e("div",Re,[e("button",{onClick:A,type:"button",class:"btn-2"},"Yes"),e("button",{onClick:c[0]||(c[0]=n=>x.value=!1),type:"button",class:"btn-3"},"No")])])])):P("",!0)])}}};export{qe as default};
