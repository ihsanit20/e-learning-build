import{E as C,r as m,G as k,b as H,J as U,o as z,d as M,e as n,f as r,i as b,F as y,g as e,t as g,q as A,H as B,h as $,z as w,I as S,n as R,x as j,A as D}from"./index-DQIf5F5M.js";const F=C("courseExam",()=>{const i=m({}),x=m({}),o=m(!1);async function _(d,l){var c,a;o.value=!0;try{const s=await k.get(`/my-courses/${d}/exams/${l}`);i.value=(s==null?void 0:s.data)??{}}catch(s){s.value=((a=(c=s==null?void 0:s.response)==null?void 0:c.data)==null?void 0:a.message)??"An error occurred"}return o.value=!1,i.value}async function h(d,l){var c,a;o.value=!0;try{const s=await k.post(`/my-courses/${d}/exams/${l}`,{user_given_answers:i.value.questions});i.value=(s==null?void 0:s.data)??{}}catch(s){s.value=((a=(c=s==null?void 0:s.response)==null?void 0:c.data)==null?void 0:a.message)??"An error occurred"}return o.value=!1,i.value}return{exam:i,error:x,loading:o,fetchExam:_,submitExam:h}}),N={class:"my-container"},P={key:0,class:"card-bg p-4 md:p-8"},Q=e("p",null,"Loading...",-1),G=[Q],J={class:"shrink-0 grow-0 card-bg p-4 sticky top-0"},W={class:"flex justify-between items-center gap-2"},q={class:"line-clamp-1"},K={class:"grow-0 shrink-0 border px-3 pt-2 pb-1 rounded-lg"},O=e("span",{class:"hidden md:inline"},"Remaining:",-1),X={class:"relative w-full h-2 bg-gray-300 rounded mt-1"},Y={class:"shrink grow mt-6 space-y-4 overflow-hidden overflow-y-auto scrollbar"},Z={class:"mb-2"},ee={class:"font-semibold"},se=["innerHTML"],te={key:0,class:"space-y-2"},ae=["name","id","value","onUpdate:modelValue"],oe=["for","innerHTML"],ne={key:1},re=["onUpdate:modelValue"],le=e("hr",{class:"my-5"},null,-1),ie={class:"flex items-center gap-1 md:gap-2"},ce=e("span",{class:"pt-1 text-xs md:text-base"},"I want to submit",-1),ue=e("br",null,null,-1),me={__name:"MyExamParticipation",setup(i){const x=H(),o=F(),_=m(!1),{courseId:h,examId:d}=x.params,{exam:l,loading:c}=U(o),a=m(0),s=m(0);z(async()=>{await o.fetchExam(h,d),l.value.duration&&(s.value=l.value.duration*60,a.value=s.value,E())});function E(){const p=setInterval(()=>{a.value>0?a.value-=1:clearInterval(p)},1e3)}const T=M(()=>{const p=Math.floor(a.value/60),v=Math.floor(p/60),t=p%60,f=a.value%60;return`${v?`${v}:`:""}${String(t).padStart(2,"0")}:${String(f).padStart(2,"0")}`}),L=M(()=>(s.value-a.value)/s.value*100),V=async()=>{await o.submitExam(h,d)};return(p,v)=>(n(),r("div",N,[b(c)?(n(),r("div",P,G)):(n(),r(y,{key:1},[e("div",J,[e("div",W,[e("h3",q,g(b(l).title),1),e("p",K,[O,A(),e("b",null,g(T.value),1)])]),e("div",X,[e("div",{class:"absolute left-0 top-0 h-full bg-blue-500 rounded",style:B({width:`${L.value}%`})},null,4)])]),e("div",Y,[(n(!0),r(y,null,$(b(l).questions,(t,f)=>(n(),r("div",{key:t.id,class:"card-bg p-4"},[e("div",Z,[e("h4",ee,"Question "+g(f+1)+":",1),e("div",{innerHTML:t.question_text},null,8,se)]),t.type==="MCQ"?(n(),r("div",te,[(n(!0),r(y,null,$(t.mcq_options,u=>(n(),r("div",{key:u.id,class:"flex items-center cursor-pointer border px-3 py-4 rounded-lg"},[w(e("input",{type:"checkbox",name:"question-"+f,id:`question:${t.id}-option:${u.id}`,value:u.id,class:"mr-2 size-4 cursor-pointer","onUpdate:modelValue":I=>t.user_answers=I},null,8,ae),[[S,t.user_answers]]),e("label",{class:"cursor-pointer",for:`question:${t.id}-option:${u.id}`,innerHTML:u.option_text},null,8,oe)]))),128))])):(n(),r("div",ne,[w(e("textarea",{class:"w-full p-2 border rounded-md",rows:"4",placeholder:"Write your answer here...","onUpdate:modelValue":u=>t.user_answers[0]=u},null,8,re),[[D,t.user_answers[0]]])]))]))),128))]),le,e("form",{onSubmit:j(V,["prevent"]),class:"grow-0 shrink-0 w-full flex justify-end gap-1 md:gap-4"},[e("label",ie,[w(e("input",{"onUpdate:modelValue":v[0]||(v[0]=t=>_.value=t),type:"checkbox",required:""},null,512),[[S,_.value]]),ce]),e("button",{type:"submit",class:R(["btn-2 disabled:opacity-50 px-1 md:px-4 text-xs md:text-base",{"opacity-50":!_.value}])}," Start Exam ",2)],32),ue],64))]))}};export{me as default};
