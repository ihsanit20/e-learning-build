import{r as c,a2 as O,x as l,y as n,z as e,A as g,M as $,C as _,Q as L,D as x,I as N,H as S,L as M,Z as U,F as j,G as B,X as V,W as z}from"./vue-CAqJJQzZ.js";import{d as w,e as F,j as I}from"./index--DNSAfWm.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-PJuFQbji.js";const R=["src"],A={class:"bg-white rounded-md p-4 w-96 relative"},E=["src"],H=["disabled"],X={key:0,class:"text-green-600 mt-2"},q={key:1,class:"text-red-600 mt-2"},G={__name:"ThumbnailUploader",props:{bundleId:{type:[Number,String],required:!0},initialThumbnail:{type:String,default:"/default-thumbnail.jpg"}},emits:["uploaded"],setup(f,{emit:p}){const i=f,v=p,r=w(),d=c(i.initialThumbnail),a=c(null),o=c(""),u=c(""),h=c(!1),y=c(!1);O(()=>i.initialThumbnail,m=>{d.value=m});const k=m=>{const t=m.target.files[0];t&&(t.size>2*1024*1024?(o.value="File should be less than 2MB",a.value=null):(a.value=t,o.value="",d.value=URL.createObjectURL(t)))},C=async()=>{if(!a.value)return;const m=new FormData;m.append("thumbnail",a.value),h.value=!0;try{await r.uploadThumbnail(i.bundleId,m),u.value="Thumbnail uploaded successfully!",a.value=null,v("uploaded")}catch(t){o.value=(t==null?void 0:t.message)??"Upload failed"}finally{h.value=!1}},b=()=>{y.value=!0},s=()=>{y.value=!1};return(m,t)=>(n(),l("div",null,[e("img",{class:"aspect-video object-cover rounded-md border overflow-hidden cursor-pointer",src:d.value,alt:"Thumbnail",onClick:b},null,8,R),t[1]||(t[1]=e("p",{class:"text-xs md:text-sm text-center mt-1"},"Click on the image to view or change.",-1)),y.value?(n(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:$(s,["self"])},[e("div",A,[e("button",{onClick:s,class:"absolute top-2 right-2 text-gray-600 hover:text-gray-900 text-xl"}," Ã— "),t[0]||(t[0]=e("h3",{class:"text-lg font-bold mb-2"},"Upload Thumbnail",-1)),e("img",{class:"aspect-video object-cover rounded-md border mb-4 w-full",src:d.value,alt:"Preview"},null,8,E),e("input",{type:"file",onChange:k,class:"input-1 py-1 w-full mb-2",accept:"image/*"},null,32),e("button",{onClick:C,class:"btn-2 w-full",disabled:h.value||!a.value},_(h.value?"Uploading...":"Upload"),9,H),u.value?(n(),l("p",X,_(u.value),1)):g("",!0),o.value?(n(),l("p",q,_(o.value),1)):g("",!0)])])):g("",!0)]))}},P=T(G,[["__scopeId","data-v-80c46c07"]]),Q={key:0,class:"modal"},W={__name:"BundleDeleteModal",props:{isOpen:Boolean,bundle:Object},emits:["close","confirmDelete"],setup(f,{emit:p}){const i=f,v=p,r=w(),d=async()=>{i.bundle&&(await r.deleteBundle(i.bundle.id),v("confirmDelete"),v("close"))},a=()=>{v("close")};return(o,u)=>f.isOpen?(n(),l("div",Q,[e("div",{class:"modal-content card-bg p-4 md:p-8"},[u[0]||(u[0]=e("h2",{class:"title-md text-red-600 text-center"},"Confirm Delete",-1)),u[1]||(u[1]=e("p",{class:"text-center"},"Are you sure you want to delete this bundle?",-1)),e("div",{class:"flex space-x-4 justify-center"},[e("button",{class:"btn-contrast",onClick:d},"Yes"),e("button",{class:"btn-2",onClick:a},"No")])])])):g("",!0)}},Y={class:"relative card-bg p-4 md:p-8 max-w-4xl max-h-[80%] overflow-y-auto"},Z=["innerHTML"],J={__name:"BundleViewModal",props:{bundle:Object,isOpen:Boolean},emits:["close"],setup(f,{emit:p}){const i=f,v=w(),r=p,d=L(()=>v.bundles.find(o=>o.id===i.bundle.id)),a=()=>{r("close")};return(o,u)=>f.isOpen?(n(),l("div",{key:0,class:"modal",onClick:$(a,["self"])},[e("div",Y,[e("div",{class:"flex top-2 right-2 z-50 absolute"},[e("button",{class:"bg-red-500 px-2 rounded-full text-white",onClick:a},"X")]),e("div",null,[x(F,{bundle:d.value,showSlotButton:!1},null,8,["bundle"])]),e("div",{innerHTML:d.value.description,class:"bg-white p-4 rounded-lg border *:mb-2.5 text-justify text-sm md:text-base"},null,8,Z)])])):g("",!0)}},K=T(J,[["__scopeId","data-v-ca5e79f4"]]),ee={class:"my-container space-y-2 relative"},te={class:"flex justify-between items-center"},se={key:0,class:"space-y-2"},le={key:1},ne={key:0,class:"text-center"},ae={key:1,class:"space-y-2"},oe={key:0,class:"card-bg md:py-4 p-4 md:p-2 grid md:grid-cols-3 lg:grid-cols-4 md:divide-x-2"},ie={class:"md:col-span-1 px-2 content-center"},de={class:"md:col-span-2 lg:col-span-3 md:px-4 space-y-2 flex flex-col justify-between"},ue={class:"flex justify-start items-center w-full gap-3"},ce={class:"shrink-0 text-xl font-semibold size-9 flex justify-center items-center border pt-1 rounded-xl"},re={class:"title-md"},pe={class:"flex flex-wrap gap-4 items-center justify-between"},me={class:"flex justify-start items-center gap-2"},ve={class:"flex justify-end items-center gap-2"},fe=["onClick"],be=["onClick"],_e={__name:"BundleList",setup(f){const p=w(),i=c([]),v=c(!1),r=c(null),d=c(!1),a=c(!1),o=c(!0),u=async()=>{o.value=!0,await p.fetchBundles(),i.value=p.bundles.sort((b,s)=>s.id-b.id),o.value=!1};N(async()=>{await u()});const h=b=>{r.value=b,d.value=!0},y=b=>{r.value=b,a.value=!0},k=async()=>{await p.deleteBundle(r.value.id),i.value=p.bundles},C=()=>{alert("Thumbnail successfully uploaded!")};return(b,s)=>{const m=U("RouterLink");return n(),l("div",ee,[e("div",te,[s[6]||(s[6]=e("h1",{class:"title-lg text-center"},"Bundles",-1)),e("div",{onClick:u,class:"bg-white border flex justify-center items-center gap-2 btn-4 cursor-pointer"},[e("i",{class:S(["fas fa-sync text-lg",{"animate-spin":o.value}])},null,2),s[3]||(s[3]=e("span",{class:"pt-1 hidden md:inline"},"Reload",-1))]),g("",!0),x(m,{class:"btn-2",to:{name:"NewBundle"}},{default:M(()=>s[5]||(s[5]=[V("Add New")])),_:1})]),o.value?(n(),l("div",se,[(n(),l(j,null,B(3,t=>e("div",{key:t,class:"card-bg md:py-2 p-4 md:p-2 grid md:grid-cols-8 md:divide-x-2 animate-pulse"},s[7]||(s[7]=[z('<div class="md:col-span-1 rounded md:px-2"><div class="aspect-video bg-gray-200"></div></div><div class="md:col-span-3 md:px-2"><div class="h-6 bg-gray-200 rounded-full mb-2"></div><div class="h-4 bg-gray-200 rounded-full"></div></div><div class="md:col-span-1 flex items-center justify-center px-2"><div class="h-6 bg-gray-200 rounded-full w-20"></div></div><div class="md:col-span-3 flex justify-between items-center gap-2 md:px-2"><div class="h-10 bg-gray-200 rounded-full w-20"></div><div class="h-10 bg-gray-200 rounded-full w-20"></div><div class="h-10 bg-gray-200 rounded-full w-20"></div><div class="h-10 bg-gray-200 rounded-full w-20"></div></div>',4)]))),64))])):(n(),l("div",le,[i.value.length===0?(n(),l("div",ne,s[8]||(s[8]=[e("p",null,"No bundles available.",-1)]))):(n(),l("ul",ae,[(n(!0),l(j,null,B(i.value,t=>(n(),l(j,{key:t.id},[!v.value||t.is_active?(n(),l("li",oe,[e("div",ie,[x(P,{"bundle-id":t.id,"initial-thumbnail":t.thumbnail,onUploaded:C},null,8,["bundle-id","initial-thumbnail"])]),e("div",de,[e("div",ue,[e("span",ce,_(t.id),1),e("h2",re,_(t.title),1)]),x(I,{bundle:t},null,8,["bundle"]),e("div",pe,[e("div",me,[g("",!0)]),e("div",ve,[e("button",{class:"btn-1 pb-1 pt-1.5 px-3",onClick:D=>h(t)},s[9]||(s[9]=[e("i",{class:"fas fa-eye"},null,-1),e("p",{class:"hidden md:flex"},"View",-1)]),8,fe),x(m,{to:{name:"BundleEditForm",params:{id:t.id}},class:"btn-1 pb-1 pt-1.5 px-3"},{default:M(()=>s[10]||(s[10]=[e("i",{class:"far fa-edit"},null,-1),e("p",{class:"hidden md:flex"},"Edit",-1)])),_:2},1032,["to"]),(n(),l("button",{key:0,class:"btn-contrast pb-2",onClick:D=>y(t)},s[11]||(s[11]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,be))])])])])):g("",!0)],64))),128))]))])),x(K,{class:"absolute top-0 shadow-2xl w-full z-40",bundle:r.value,isOpen:d.value,onClose:s[1]||(s[1]=t=>d.value=!1)},null,8,["bundle","isOpen"]),x(W,{class:"absolute top-0 shadow-2xl w-full z-40",bundle:r.value,isOpen:a.value,onClose:s[2]||(s[2]=t=>a.value=!1),onConfirmDelete:k},null,8,["bundle","isOpen"])])}}};export{_e as default};
