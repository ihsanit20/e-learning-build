import{r as s,P as A,I,x as r,z as t,C as V,A as N,U as u,af as j,F as z,G,B as P,W as _,ac as S,a9 as k,D as U,L as h,Y as W,M as Y,T as $,y as i}from"./vue-BP9P6hCg.js";import{u as q,a as H,f as J}from"./index-BnhZ8BsX.js";import{_ as K}from"./TextEditor-DdzDIBRv.js";import"./vendor-PJuFQbji.js";const O={class:"my-container space-y-2"},Q={class:"grid md:grid-cols-5 gap-2 items-center border p-2"},X=["src"],Z={key:1,class:"col-span-1 flex items-center justify-center"},ee={class:"md:col-span-4 space-y-2"},te={class:"flex w-full text-center gap-4"},le=["disabled"],oe={class:"text-center text-green-600"},se={class:"text-center text-red-600"},ae={class:"space-y-2 bg-gray-100 p-2 rounded-md"},ue=["value"],ne={class:"flex items-center gap-2"},re={key:0},ie={class:"border md:p-4 p-2 rounded-md bg-white"},de={class:"flex justify-center gap-4"},fe={__name:"CourseEditForm",setup(pe){const D=A(),L=$(),p=q(),F=H(),v=s(""),c=s(""),m=s(""),M=s(""),y=s(""),f=s(""),a=s(""),g=s(""),d=s(null),w=s(""),n=s(""),b=s(!1),C=D.params.id,T=async()=>{try{await p.fetchCourse(C);const o=p.course;o&&(v.value=o.title,c.value=o.description,m.value=o.price,M.value=o.thumbnail,y.value=o.start_date?J(new Date(o.start_date),"yyyy-MM-dd"):"",f.value=o.category_id,a.value=o.course_type,g.value=o.facebook_group_link||"")}catch(o){console.error("Error loading course:",o),n.value="Failed to load course data"}},B=async()=>{var e,x;const o={id:C,title:v.value,description:c.value,price:m.value,start_date:a.value==="Live Course"?y.value:null,category_id:f.value,course_type:a.value,facebook_group_link:g.value};try{await p.updateCourse(C,o),w.value="Course updated successfully!",L.push("/management/course-list")}catch(l){console.error("Error updating course:",l),n.value=((x=(e=l==null?void 0:l.response)==null?void 0:e.data)==null?void 0:x.message)??"An error occurred while updating the course"}},E=o=>{const e=o.target.files[0];e&&e.size>2*1024*1024?(n.value="File should be less than 2MB",d.value=null,document.getElementById("file-input").value=""):(d.value=e,n.value="")},R=async()=>{if(!d.value)return;b.value=!0;const o=new FormData;o.append("thumbnail",d.value);try{await p.uploadThumbnail(C,o),w.value="ছবি আপলোড সফল হয়েছে",d.value=null,document.getElementById("file-input").value="",location.reload()}catch(e){console.error("Error uploading thumbnail:",e),n.value="An error occurred while uploading the thumbnail"}finally{b.value=!1}};return I(async()=>{await F.fetchCategories(),await T()}),(o,e)=>{const x=W("RouterLink");return i(),r("div",O,[e[22]||(e[22]=t("h2",{class:"title-md text-center"},"Edit Course",-1)),t("div",Q,[b.value?(i(),r("div",Z,e[8]||(e[8]=[t("div",{class:"loader"},null,-1)]))):(i(),r("img",{key:0,class:"col-span-1 aspect-video object-cover rounded-md",src:M.value,alt:"Thumbnail"},null,8,X)),t("div",ee,[t("div",te,[t("input",{id:"file-input",type:"file",onChange:E,class:"input-1"},null,32),t("button",{class:"btn-2",onClick:R,type:"button",disabled:b.value}," Upload ",8,le)]),e[9]||(e[9]=t("p",{class:"text-sm text-center text-red-600"}," **File size max: 1.9 MB. Aspect ratio: 9:16 (720px x 1280px)** ",-1)),t("p",oe,V(w.value),1),t("p",se,V(n.value),1)])]),t("form",{onSubmit:Y(B,["prevent"])},[t("div",ae,[t("div",null,[e[11]||(e[11]=t("p",null,"Course Category",-1)),u(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>f.value=l),class:"input-1"},[e[10]||(e[10]=t("option",{disabled:"",value:""},"Select a Category",-1)),(i(!0),r(z,null,G(P(F).categories,l=>(i(),r("option",{key:l.id,value:l.id},V(l.name),9,ue))),128))],512),[[j,f.value]])]),t("div",null,[e[14]||(e[14]=t("p",null,"Course Type",-1)),t("div",ne,[t("label",null,[u(t("input",{type:"radio",value:"Live Course","onUpdate:modelValue":e[1]||(e[1]=l=>a.value=l)},null,512),[[S,a.value]]),e[12]||(e[12]=_(" Live Course "))]),t("label",null,[u(t("input",{type:"radio",value:"Recorded Course","onUpdate:modelValue":e[2]||(e[2]=l=>a.value=l)},null,512),[[S,a.value]]),e[13]||(e[13]=_(" Recorded Course "))])])]),t("div",null,[e[15]||(e[15]=t("p",null,"Course Title",-1)),u(t("input",{class:"input-1","onUpdate:modelValue":e[3]||(e[3]=l=>v.value=l),placeholder:"Title"},null,512),[[k,v.value]])]),t("div",null,[e[16]||(e[16]=t("p",null,"Course Price",-1)),u(t("input",{class:"input-1","onUpdate:modelValue":e[4]||(e[4]=l=>m.value=l),placeholder:"Price"},null,512),[[k,m.value]])]),a.value==="Live Course"?(i(),r("div",re,[e[17]||(e[17]=t("p",null,"Start Date",-1)),u(t("input",{class:"input-1",type:"date","onUpdate:modelValue":e[5]||(e[5]=l=>y.value=l),placeholder:"Start Date"},null,512),[[k,y.value]])])):N("",!0),t("div",null,[e[18]||(e[18]=t("p",null,"Facebook Group Link",-1)),u(t("input",{type:"url",class:"input-1","onUpdate:modelValue":e[6]||(e[6]=l=>g.value=l),placeholder:"Facebook Group Link"},null,512),[[k,g.value]])]),t("div",null,[e[19]||(e[19]=t("p",null,"Course Description",-1)),t("div",ie,[U(K,{modelValue:c.value,"onUpdate:modelValue":e[7]||(e[7]=l=>c.value=l),placeholder:"Description"},null,8,["modelValue"])])])]),t("div",de,[e[21]||(e[21]=t("button",{class:"btn-2",type:"submit"},"Save",-1)),U(x,{class:"btn-contrast",to:"/management/course-list"},{default:h(()=>e[20]||(e[20]=[_("Cancel")])),_:1})])],32)])}}};export{fe as default};
