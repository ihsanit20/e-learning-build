import{r as v,w as C,e as l,f as u,g as e,t as q,x as j,E as k,p as y,F as E,h as I,z as T,a2 as L,A,j as V,q as N}from"./index-BMsmsKno.js";import{u as D}from"./question-BJysx68f.js";import{_ as $}from"./TextEditor-B2rzrXCS.js";const B={class:"modal"},P={class:"modal-content space-y-2 max-w-[720px] min-w-80 md:min-w-[480px] lg:min-w-[580px]"},H={key:0,class:"text-red-500"},F={key:1,class:"text-red-500"},R={key:2,class:"grid py-2 gap-1.5 bg-gray-200 rounded-lg"},z=e("div",{class:"flex justify-between text-sm px-2"},[e("p",null,"Ans"),e("p",null,"Options"),e("p",null,"Delete")],-1),W=["onPaste"],Z=["onUpdate:modelValue"],G={class:"flex-1"},J={key:0,class:"mt-2 relative"},K=["innerHTML"],X=["onClick"],Y=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"},null,-1),ee=[Y],te=["onUpdate:modelValue"],se={class:"grow-0 shrink-0 flex items-center"},oe=["onClick"],ne={class:"grid"},ie=e("h2",{class:"text-center md:text-left"},"Question Explanation",-1),ae={class:"flex gap-4 justify-center"},le=e("button",{type:"submit",class:"btn-2"},"Save Question",-1),M={__name:"QuestionForm",props:{question:Object,chapterId:[String,Number],questionType:String},emits:["close"],setup(r,{emit:h}){var g,b,w;const d=h,p=D(),s=r,a=v(((g=s.question)==null?void 0:g.question_text)||""),m=v(((b=s.question)==null?void 0:b.explanation)||""),i=v(((w=s.question)==null?void 0:w.mcq_options)||[{option_text:"",is_correct:!1},{option_text:"",is_correct:!1},{option_text:"",is_correct:!1},{option_text:"",is_correct:!1}]),_=v({}),f=()=>{i.value.push({option_text:"",is_correct:!1})},S=o=>{i.value.splice(o,1)},O=async o=>{const n=document.createElement("img");n.src=URL.createObjectURL(o),await new Promise(c=>{n.onload=c});const t=document.createElement("canvas");return t.width=n.width,t.height=n.height,t.getContext("2d").drawImage(n,0,0),t.toDataURL("image/webp")},Q=async(o,n)=>{const t=o.clipboardData||window.clipboardData;if(t.files.length>0){const x=t.files[0];if(x.type.startsWith("image/")){n.option_text="";const c=await O(x);n.option_text=`<img src="${c}" alt="Option Image" />`}}};C(()=>s.question,o=>{o&&(a.value=o.question_text,m.value=o.explanation,i.value=o.mcq_options||[])},{immediate:!0});const U=async()=>{_.value={};try{s.question?await p.update(s.question.id,{question_text:a.value,chapter_id:s.question.chapter_id,explanation:m.value,mcq_options:i.value}):await p.store({chapter_id:s.chapterId,type:s.questionType,question_text:a.value,explanation:m.value,mcq_options:i.value}),a.value="",m.value="",i.value=[{option_text:"",is_correct:!1},{option_text:"",is_correct:!1},{option_text:"",is_correct:!1},{option_text:"",is_correct:!1}],d("close")}catch(o){o.response&&o.response.data&&o.response.data.errors&&(_.value=o.response.data.errors)}};return(o,n)=>(l(),u("div",B,[e("div",P,[e("h2",null,q(s.question?"Edit":"Add")+" Question",1),e("form",{onSubmit:j(U,["prevent"]),class:"space-y-4"},[k($,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=t=>a.value=t),placeholder:"Question Text",required:""},null,8,["modelValue"]),_.value.question_text?(l(),u("div",H,q(_.value.question_text[0]),1)):y("",!0),_.value.chapter_id?(l(),u("div",F,q(_.value.chapter_id[0]),1)):y("",!0),r.questionType==="MCQ"?(l(),u("div",R,[z,(l(!0),u(E,null,I(i.value,(t,x)=>(l(),u("div",{key:x,class:"flex items-center gap-4 px-4",onPaste:c=>Q(c,t)},[T(e("input",{class:"grow-0 shrink-0",value:!0,name:"correct",type:"checkbox","onUpdate:modelValue":c=>t.is_correct=c},null,8,Z),[[L,t.is_correct]]),e("div",G,[t.option_text.includes("<img")?(l(),u("div",J,[e("div",{innerHTML:t.option_text},null,8,K),(l(),u("svg",{onClick:c=>t.option_text="",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"cursor-pointer absolute -top-2.5 -left-2.5 size-6 bg-white rounded-full border shadow text-red-500"},ee,8,X))])):T((l(),u("input",{key:1,class:"input-1 text-black placeholder:italic bg-white w-full",type:"text","onUpdate:modelValue":c=>t.option_text=c,placeholder:"Option (text or image)",required:""},null,8,te)),[[A,t.option_text]])]),e("div",se,[e("i",{onClick:c=>S(x),class:"fa fa-trash text-red-700 cursor-pointer ml-2"},null,8,oe)])],40,W))),128)),e("div",{class:"flex justify-center items-center pt-0.5"},[e("button",{type:"button",onClick:f,class:"px-2 pt-1 border rounded bg-gray-300 border-gray-400"}," + Add Option ")])])):y("",!0),e("div",ne,[ie,k($,{class:"input-1",modelValue:m.value,"onUpdate:modelValue":n[1]||(n[1]=t=>m.value=t),placeholder:"Question Explanation"},null,8,["modelValue"])]),e("div",ae,[le,e("button",{type:"button",onClick:n[2]||(n[2]=t=>d("close")),class:"btn-contrast"},"Cancel")])],32)])]))}},fe={__name:"AddQuestionModal",props:{chapterId:{type:[String,Number],required:!0},questionType:String},emits:["close"],setup(r,{emit:h}){const d=h;return(p,s)=>(l(),V(M,{chapterId:r.chapterId,questionType:r.questionType,onClose:s[0]||(s[0]=a=>d("close"))},null,8,["chapterId","questionType"]))}},re={key:0,class:"modal"},ce={class:"modal-content space-y-2"},ue=e("h2",null,"Delete Question",-1),de={class:"py-2 space-y-1"},pe=e("hr",null,null,-1),_e=["innerHTML"],me=e("hr",null,null,-1),he={key:0,class:"text-red-500"},xe={class:"flex gap-4"},ge={__name:"DeleteQuestionModal",props:{question:{type:Object,required:!0,default:()=>({name:"",id:null})}},emits:["close"],setup(r,{emit:h}){const d=h,p=r,s=D(),a=v({});C(()=>p.question,i=>{},{immediate:!0});const m=async()=>{a.value={};try{await s.delete(p.question.id),d("close")}catch(i){i.response&&i.response.data&&i.response.data.errors&&(a.value=i.response.data.errors)}};return(i,_)=>p.question?(l(),u("div",re,[e("div",ce,[ue,e("div",de,[N(" Are you sure you want to delete the question ID:"+q(r.question.id)+"? ",1),pe,e("div",{class:"overflow-hidden whitespace-pre-wrap line-clamp-3 italic",innerHTML:p.question.question_text},null,8,_e),me]),a.value.chapter_id?(l(),u("div",he,q(a.value.chapter_id[0]),1)):y("",!0),e("div",xe,[e("button",{onClick:m,class:"btn-2"},"Delete"),e("button",{type:"button",onClick:_[0]||(_[0]=f=>d("close")),class:"btn-contrast"},"Cancel")])])])):y("",!0)}},be={__name:"EditQuestionModal",props:{question:{type:Object,required:!0},questionType:String},emits:["close"],setup(r,{emit:h}){const d=h;return(p,s)=>(l(),V(M,{question:r.question,questionType:r.questionType,onClose:s[0]||(s[0]=a=>d("close"))},null,8,["question","questionType"]))}};export{fe as _,be as a,ge as b};
