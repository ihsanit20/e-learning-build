import{r,Q as u,I as A,x as p,z as e,A as D,H as i,C as n,M as F,U as x,D as k,a9 as B,F as L,G as P,L as R,Z as j,T as z,y as v,X as w}from"./vue-CAqJJQzZ.js";import{d as E,u as H}from"./index-_BXdcGLR.js";import{_ as K}from"./TextEditor-iSTvUU0S.js";import"./vendor-PJuFQbji.js";const $={class:"my-container"},q={class:"card-bg p-4 md:p-8"},G={class:"flex flex-wrap justify-between mb-4"},Q={class:"flex items-center flex-wrap gap-2 text-sm"},X={class:"border p-4 rounded-md grid sm:grid-cols-2 lg:grid-cols-3 gap-4"},Z={class:"border p-4 rounded-md grid grid-cols-2 gap-2 items-center"},J={class:"flex items-start gap-2"},O=["onClick"],W={class:"space-x-1"},Y={class:"shrink-0 grow-0"},ee={class:"block"},se=["onUpdate:modelValue"],te={class:"flex gap-4 justify-between"},oe=["disabled"],le={key:0,class:"message"},de={__name:"BundleForm",setup(ae){const I=E(),m=H(),T=z(),d=r(""),_=r(""),l=r([]),b=r(""),c=r(""),M=async()=>{const t={title:d.value,description:_.value,bundle_courses:l.value};try{await I.createBundle(t),b.value="The bundle is successfully added",setTimeout(()=>T.push("/management/bundle-list"),2e3)}catch(s){console.error("Failed to add bundle:",s)}},N=u(()=>m.courses.filter(t=>l.value.some(s=>parseInt(s.course_id)===parseInt(t.id))));A(async()=>{m.fetchCourses({price:"paid",status:"active",publish:"published"})});function S(){var o;const t=parseInt(c.value);if(!t)return;const s=l.value.some(a=>parseInt(a.course_id)===t),h=(o=m.courses)==null?void 0:o.some(a=>parseInt(a.id)===t);!s&&h&&l.value.push({course_id:t,course_price:""}),c.value=""}function U(t){confirm("Are you want to remove this")&&l.value.splice(t,1)}const f=u(()=>!!d.value),g=u(()=>l.value.length>=2),y=u(()=>l.value.length>=2&&l.value.every(t=>t.course_price!==""&&Number(t.course_price)>=0)),C=u(()=>f.value&&g.value&&y.value);return(t,s)=>{const h=j("RouterLink");return v(),p("div",$,[e("div",q,[e("div",G,[s[3]||(s[3]=e("h1",{class:"title-lg"},"Add New Bundle",-1)),e("div",Q,[e("div",{class:i(f.value?"text-green-600":"text-gray-600")},n(f.value?"✅":"-")+" Bundle Title ",3),e("div",{class:i(g.value?"text-green-600":"text-gray-600")},n(g.value?"✅":"-")+" Minimum 2 courses ",3),e("div",{class:i(y.value?"text-green-600":"text-gray-600")},n(y.value?"✅":"-")+" Bundle Price ",3)])]),e("form",{onSubmit:F(M,["prevent"]),class:"space-y-4"},[x(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>d.value=o),placeholder:"Bundle Title",class:"input-1 w-full"},null,512),[[B,d.value]]),e("div",X,[e("div",Z,[x(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>c.value=o),class:"input-1 text-center pb-1.5",placeholder:"Course ID"},null,512),[[B,c.value]]),e("button",{onClick:S,type:"button",class:"btn-1 py-2"},"+ Add")]),(v(!0),p(L,null,P(N.value,(o,a)=>(v(),p("div",{key:o.id,class:i(["border p-4 rounded-md space-y-2 text-center relative",{"col-start-1":!a}])},[e("div",J,[e("i",{onClick:V=>U(a),class:"shrink-0 grow-0 fa fa-trash text-red-600 cursor-pointer"},null,8,O),e("div",W,[e("b",Y,n(o.id),1),e("i",null,n(o.title),1)])]),e("div",null,"Course Price: "+n(o.price)+" TK",1),e("label",ee,[s[4]||(s[4]=w(" Bundle Price ")),x(e("input",{type:"number","onUpdate:modelValue":V=>l.value[a].course_price=V,class:"input-1 max-w-24 py-1",min:"0",required:""},null,8,se),[[B,l.value[a].course_price]]),s[5]||(s[5]=w(" TK "))])],2))),128))]),k(K,{modelValue:_.value,"onUpdate:modelValue":s[2]||(s[2]=o=>_.value=o)},null,8,["modelValue"]),e("div",te,[k(h,{to:"/management/bundle-list",class:"btn-contrast"},{default:R(()=>s[6]||(s[6]=[w("← Back")])),_:1}),e("button",{type:"submit",class:i(["btn-2",{"opacity-50 cursor-not-allowed":!C.value}]),disabled:!C.value}," Add Bundle ",10,oe)])],32),b.value?(v(),p("p",le,n(b.value),1)):D("",!0)])])}}};export{de as default};
