import{J as N,K as B,u as M,r as n,c as C,o as j,d as r,e as t,z as p,N as k,A as y,F as P,f as V,g as c,q as F,t as o,i as d}from"./index-DN8cqjEB.js";const O=N("transaction",{state:()=>({transactions:[],error:null}),actions:{async fetchTransactions(D={}){var a,b;try{const l=await B.get("/transactions",{params:D});this.transactions=(l==null?void 0:l.data)??[]}catch(l){this.error=((b=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:b.message)??"An error occurred"}}}}),R={class:"container mx-auto p-4"},X={class:"mb-4 flex md:flex-row flex-col gap-4"},q=["value"],z={class:"flex justify-center gap-4 text-sm"},E={class:"font-semibold"},J={class:"font-semibold"},K={class:"overflow-x-auto"},G={class:"min-w-full bg-white border border-gray-200 rounded-lg text-sm"},H={key:0},Q={class:"py-0.5 px-2 border"},W={class:"py-0.5 px-2 border"},Y={class:"py-0.5 px-2 border"},Z={class:"py-0.5 px-2 border"},$={class:"py-0.5 px-2 border"},tt={class:"py-0.5 px-2 border text-green-600 font-semibold"},et={class:"py-0.5 px-2 border"},st={class:"py-0.5 px-2 border"},at={key:2},ot={class:"mt-4 flex justify-between"},lt=["disabled"],nt=["disabled"],dt={__name:"TransactionList",setup(D){const a=O(),b=M(),l=n(new Date(new Date().setDate(new Date().getDate()-30)).toISOString().split("T")[0]),f=n(new Date().toISOString().split("T")[0]),x=n(1),_=n("paid"),g=n(""),m=n(""),h=n(""),w=n(!1),U=C(()=>{var u;return((u=a.transactions.data)==null?void 0:u.length)||0}),A=C(()=>{var u;return((u=a.transactions.data)==null?void 0:u.reduce((e,v)=>e+parseFloat(v.paid_amount),0))||0}),i=async()=>{w.value=!0,await a.fetchTransactions({from:l.value,to:f.value,page:x.value,status:_.value,course_id:g.value,trx_id:m.value,phone:h.value}),w.value=!1};j(async()=>{await i(),await b.fetchCourses()});const I=()=>{a.transactions.next_page_url&&(x.value++,i())},L=()=>{a.transactions.prev_page_url&&(x.value--,i())};return(u,e)=>{var v,T,S;return d(),r("div",R,[e[12]||(e[12]=t("h1",{class:"text-2xl font-bold mb-4"},"Transaction List",-1)),t("div",X,[p(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>_.value=s),onChange:i,class:"input-1 w-full"},e[6]||(e[6]=[t("option",{value:"all"},"All",-1),t("option",{value:"paid"},"Paid",-1),t("option",{value:"free"},"Free",-1)]),544),[[k,_.value]]),p(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>l.value=s),class:"input-1 w-full",placeholder:"From Date"},null,512),[[y,l.value]]),p(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>f.value=s),class:"input-1 w-full",placeholder:"To Date"},null,512),[[y,f.value]]),p(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>g.value=s),onChange:i,class:"input-1 w-full"},[e[7]||(e[7]=t("option",{value:""},"Select Course",-1)),(d(!0),r(P,null,V(c(b).courses,s=>(d(),r("option",{key:s.id,value:s.id},o(s.title),9,q))),128))],544),[[k,g.value]]),p(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=s=>m.value=s),class:"input-1 w-full",placeholder:"Search by TRX ID"},null,512),[[y,m.value]]),p(t("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=s=>h.value=s),class:"input-1 w-full",placeholder:"Search by Phone"},null,512),[[y,h.value]]),t("button",{onClick:i,class:"btn-2"},"Filter")]),t("div",z,[t("span",E,"Visible Data: "+o(U.value),1),e[8]||(e[8]=F(" || ")),t("span",J,"Total Amount: ৳ "+o(A.value.toFixed(2)),1)]),t("div",K,[t("table",G,[e[11]||(e[11]=t("thead",null,[t("tr",{class:"bg-gray-200 text-left"},[t("th",{class:"py-0.5 px-2 border"},"Date"),t("th",{class:"py-0.5 px-2 border"},"User"),t("th",{class:"py-0.5 px-2 border"},"Phone"),t("th",{class:"py-0.5 px-2 border"},"Course"),t("th",{class:"py-0.5 px-2 border"},"TRX ID"),t("th",{class:"py-0.5 px-2 border"},"Paid Amount"),t("th",{class:"py-0.5 px-2 border"},"Coupon Code"),t("th",{class:"py-0.5 px-2 border"},"Discount")])],-1)),t("tbody",null,[w.value?(d(),r("tr",H,e[9]||(e[9]=[t("td",{colspan:"8",class:"text-center py-4"},[t("span",{class:"loader"}),F(" Loading transactions... ")],-1)]))):((S=(T=(v=c(a))==null?void 0:v.transactions)==null?void 0:T.data)==null?void 0:S.length)>0?(d(!0),r(P,{key:1},V(c(a).transactions.data,s=>(d(),r("tr",{key:s.id,class:"border-b"},[t("td",Q,o(s.date),1),t("td",W,o(s.user.name),1),t("td",Y,o(s.user.phone),1),t("td",Z,o(s.course.title),1),t("td",$,o(s.trx_id),1),t("td",tt," ৳ "+o(s.paid_amount),1),t("td",et,o(s.coupon_code),1),t("td",st,"৳ "+o(s.discount_amount),1)]))),128)):(d(),r("tr",at,e[10]||(e[10]=[t("td",{colspan:"8",class:"text-center py-4"},"No transactions found",-1)])))])])]),t("div",ot,[t("button",{onClick:L,disabled:!c(a).transactions.prev_page_url,class:"bg-gray-300 px-4 py-2 rounded disabled:opacity-50"}," Previous ",8,lt),t("span",null,"Page "+o(x.value)+" of "+o(c(a).transactions.last_page),1),t("button",{onClick:I,disabled:!c(a).transactions.next_page_url,class:"bg-gray-300 px-4 py-2 rounded disabled:opacity-50"}," Next ",8,nt)])])}}};export{dt as default};
