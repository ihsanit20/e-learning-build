import{Q as V,I as B,x as n,z as t,X as v,C as d,M as w,B as p,F as b,G as h,y as l,r as k,O as j,A as F,U as _,a9 as q,ag as U}from"./vue-CcEtAIOs.js";import{u as E}from"./coupon-HVgfSDOB.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as K}from"./index-clbmm86J.js";import"./vendor-PJuFQbji.js";const L={class:"bg-white border rounded-lg w-full max-w-3xl p-4 max-h-[80vh]"},z={class:"flex justify-between items-center gap-2"},G={class:"mb-0"},P={class:"border px-3 pt-2 pb-1 rounded-lg"},Y={key:0},H={class:"text-right"},R={key:1,class:"flex justify-center items-center py-20 text-red-600"},O={__name:"CouponEarnListModal",props:{code:String,onClose:Function},setup(f){const u=f,c=E(),x=V(()=>{const m=c.userEarnings.reduce((s,a)=>s+parseInt(a.commission_amount),0);return parseInt(m)});return B(()=>{c.fetchUserEarnings({code:u.code})}),(m,s)=>{var a,y;return l(),n("div",{onClick:s[1]||(s[1]=w((...r)=>f.onClose&&f.onClose(...r),["self"])),class:"fixed inset-0 w-full h-full flex justify-center pt-16 bg-black/40 z-[99999999]"},[t("div",L,[t("div",z,[t("h2",G,[s[2]||(s[2]=v(" Earnings for Code: ")),t("b",P,d(f.code),1)]),t("i",{onClick:s[0]||(s[0]=w((...r)=>f.onClose&&f.onClose(...r),["self"])),class:"fal fa-window-close text-3xl cursor-pointer text-red-500"})]),s[5]||(s[5]=t("hr",{class:"my-3"},null,-1)),(y=(a=p(c))==null?void 0:a.userEarnings)!=null&&y.length?(l(),n("div",Y,[t("p",null,[s[3]||(s[3]=v(" Total Earnings: ")),t("strong",null,d(x.value)+" TK",1)]),t("table",null,[s[4]||(s[4]=t("thead",null,[t("tr",null,[t("th",null,"Date"),t("th",null,"Course"),t("th",{class:"text-right"},"Amount")])],-1)),t("tbody",null,[(l(!0),n(b,null,h(p(c).userEarnings,r=>{var g;return l(),n("tr",{key:r.id},[t("td",null,d(r.date),1),t("td",null,d((g=r==null?void 0:r.course)==null?void 0:g.title),1),t("td",null,[t("div",H,d(parseInt(r.commission_amount))+" TK",1)])])}),128))])])])):(l(),n("div",R," No earnings found for this promo code. "))])])}}},Q=D(O,[["__scopeId","data-v-c0b8d3e2"]]),X={class:"my-container mx-auto p-4"},J={key:0,class:"py-8"},W={class:"py-4"},Z={key:0},tt={class:"grid md:grid-cols-2 gap-4"},et={class:"col-span-full"},ot=["value"],st={key:1,class:"py-4"},lt={class:"flex flex-wrap items-center gap-3"},nt={class:"flex gap-3 items-center"},it=["onClick"],at=["value"],rt=["onClick"],dt={class:"ml-auto flex gap-3 items-center"},ut={class:"border px-3 pt-2 pb-1 rounded-lg text-sm md:text-base"},ct={class:"border px-3 pt-2 pb-1 rounded-lg text-sm md:text-base"},pt={key:1,class:"text-red-600 py-4 text-center"},yt={__name:"MyAffiliate",setup(f){const u=K(),c=E(),x=k(""),m=k(!1),s=k(!1),a=k({institute:"",session:"",group:""});B(()=>{c.fetchUserCoupons()});const y=i=>{i&&(x.value=i,m.value=!0)},r=async()=>{const i=await u.applyAffiliate({additional_info:a.value});u.user.affiliate_status=i==null?void 0:i.affiliate_status,u.user.additional_info=i==null?void 0:i.additional_info,s.value=!1},g=Array.from({length:51},(i,e)=>new Date().getFullYear()-e);function I(i){if(navigator.clipboard&&typeof navigator.clipboard.writeText=="function")navigator.clipboard.writeText(i).then(()=>alert("Promo code link copied to clipboard!")).catch(e=>console.error("Failed to copy: ",e));else{const e=document.createElement("input");e.value=i,document.body.appendChild(e),e.select();try{document.execCommand("copy"),alert("Promo code link copied to clipboard!")}catch(C){console.error("Fallback copy failed: ",C)}document.body.removeChild(e)}}return(i,e)=>{var C,S,A,$,M,T;return l(),n(b,null,[t("div",X,[e[17]||(e[17]=t("h1",{class:"title-xl"},"My Affiliate",-1)),p(u).loading?(l(),n("div",J,"Loading...")):(l(),n(b,{key:1},[t("div",W,[e[5]||(e[5]=v(" Affiliate Status: ")),t("b",null,d(((S=(C=p(u))==null?void 0:C.user)==null?void 0:S.affiliate_status)??"N/A"),1)]),($=(A=p(u))==null?void 0:A.user)!=null&&$.affiliate_status?(l(),n("div",st,[e[16]||(e[16]=t("h2",{class:"text-xl font-semibold"},"Promo Codes",-1)),(T=(M=p(c))==null?void 0:M.userCoupons)!=null&&T.length?(l(!0),n(b,{key:0},h(p(c).userCoupons,o=>(l(),n("div",{key:o.id,class:"bg-white p-3 rounded-lg mb-3"},[t("div",lt,[t("div",nt,[t("button",{onClick:N=>y(o.code),class:"px-3 pt-2.5 pb-2 border rounded-lg btn-2",type:"button"}," Earnings ",8,it),t("input",{class:"input-1 text-black w-40 text-center",type:"text",value:o.code,readonly:""},null,8,at),t("button",{class:"shrink-0 grow-0 border rounded-lg px-3 pt-2 pb-1.5",type:"button",onClick:N=>I(o.code)},e[15]||(e[15]=[t("i",{class:"far fa-copy"},null,-1)]),8,rt)]),t("div",dt,[t("div",ut," Discount: "+d(o.discount_value)+d(o.discount_type==="percentage"?"%":"TK"),1),t("div",ct," Commission: "+d(o.commission_value)+d(o.discount_type==="percentage"?"%":"TK"),1)])])]))),128)):(l(),n("div",pt,"-- Coupon Code Not Found! --"))])):(l(),n("div",Z,[t("button",{onClick:e[0]||(e[0]=o=>s.value=!0),type:"button",class:"btn-2"}," Request for Affiliate "),s.value?(l(),n("div",{key:0,onClick:e[4]||(e[4]=w(o=>s.value=!1,["self"])),class:"fixed inset-0 flex pt-16 justify-center w-full h-full bg-black/40 z-[999999]"},[t("form",{onSubmit:w(r,["prevent"]),class:"bg-white p-4 rounded-lg border w-full max-w-xl max-h-[80vh] overflow-y-auto mb-auto"},[e[11]||(e[11]=t("h3",{class:"text-xl font-semibold"},"Affiliate Form",-1)),e[12]||(e[12]=t("hr",{class:"my-3"},null,-1)),t("div",tt,[t("label",et,[e[6]||(e[6]=v(" College / University ")),_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.institute=o),type:"text",class:"input-1",required:""},null,512),[[q,a.value.institute]])]),t("label",null,[e[8]||(e[8]=v(" HSC Batch (Year) ")),_(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.session=o),class:"input-1 text-center",required:""},[e[7]||(e[7]=t("option",{value:""},"-- Select Year --",-1)),(l(!0),n(b,null,h(p(g),o=>(l(),n("option",{key:o,value:o},d(o),9,ot))),128))],512),[[U,a.value.session]])]),t("label",null,[e[10]||(e[10]=v(" HSC Group ")),_(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.group=o),class:"input-1 text-center",required:""},e[9]||(e[9]=[t("option",{value:""},"-- Select Group --",-1),t("option",{value:"Science"},"Science",-1),t("option",{value:"Arts"},"Arts",-1),t("option",{value:"Commerce"},"Commerce",-1)]),512),[[U,a.value.group]])])]),e[13]||(e[13]=t("hr",{class:"my-3"},null,-1)),e[14]||(e[14]=t("div",{class:"flex justify-end items-center"},[t("button",{class:"btn-2",type:"submit"},"Submit")],-1))],32)])):F("",!0)]))],64))]),m.value?(l(),j(Q,{key:0,code:x.value,onClose:()=>m.value=!1},null,8,["code","onClose"])):F("",!0)],64)}}};export{yt as default};
