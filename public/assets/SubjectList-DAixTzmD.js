import{D as T,E as j,r as p,d as r,e as _,f as t,m as L,p as N,v as q,t as v,q as b,H as $,I as k,w,b as U,o as H,s as Q,y as A,z as D,x as S,h as E,F as G,g as J,i as x}from"./index-CcZtx1wx.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";const g=T("subject",{state:()=>({subjects:[],error:null,loading:!1}),actions:{async index(s){var n,a;this.loading=!0,this.error=null;try{const e=await j.get(`/subjects?category_id=${s}`);this.subjects=(e==null?void 0:e.data)??[]}catch(e){this.error=((a=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:a.message)??"An error occurred while fetching subjects"}finally{this.loading=!1}},async store(s){var n,a;this.error=null;try{const e=await j.post("/subjects",s);this.subjects.push(e==null?void 0:e.data)}catch(e){throw this.error=((a=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:a.message)??"An error occurred while creating the subject",e}},async update(s,n){var a,e;this.error=null;try{const l=await j.put(`/subjects/${s}`,n),o=this.subjects.findIndex(c=>c.id===s);o!==-1&&(this.subjects[o]=(l==null?void 0:l.data)??this.subjects[o])}catch(l){throw this.error=((e=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:e.message)??"An error occurred while updating the subject",l}},async delete(s){var n,a;this.error=null;try{await j.delete(`/subjects/${s}`),this.subjects=this.subjects.filter(e=>e.id!==s)}catch(e){throw this.error=((a=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:a.message)??"An error occurred while deleting the subject",e}}}}),V=s=>($("data-v-4468764b"),s=s(),k(),s),K={class:"modal"},P={class:"modal-content space-y-2"},W=V(()=>t("h2",null,"Add Subject",-1)),X={key:0,class:"text-red-500"},Y={key:1,class:"text-red-500"},Z={class:"flex gap-4"},ee=V(()=>t("button",{type:"submit",class:"btn-2"},"Add",-1)),te={__name:"AddSubjectModal",props:{categoryId:{type:Number,required:!0}},emits:["close"],setup(s,{emit:n}){const a=n,e=s,l=g(),o=p(""),c=p({}),i=async()=>{c.value={};try{await l.store({name:o.value,category_id:e.categoryId}),o.value="",a("close")}catch(u){u.response&&u.response.data&&u.response.data.errors&&(c.value=u.response.data.errors)}};return(u,d)=>(r(),_("div",K,[t("div",P,[W,t("form",{onSubmit:L(i,["prevent"]),class:"space-y-2"},[N(t("input",{class:"input-1","onUpdate:modelValue":d[0]||(d[0]=h=>o.value=h),placeholder:"Subject name",required:""},null,512),[[q,o.value]]),c.value.name?(r(),_("div",X,v(c.value.name[0]),1)):b("",!0),c.value.category_id?(r(),_("div",Y,v(c.value.category_id[0]),1)):b("",!0),t("div",Z,[ee,t("button",{type:"button",onClick:d[1]||(d[1]=h=>a("close")),class:"btn-contrast"},"Cancel")])],32)])]))}},se=C(te,[["__scopeId","data-v-4468764b"]]),B=s=>($("data-v-c7838ff7"),s=s(),k(),s),ae={class:"modal"},oe={class:"modal-content space-y-2"},ce=B(()=>t("h2",null,"Edit Subject",-1)),ne={key:0,class:"text-red-500"},le={key:1,class:"text-red-500"},re={class:"flex gap-4"},de=B(()=>t("button",{type:"submit",class:"btn-2"},"Save",-1)),ie={__name:"EditSubjectModal",props:{subject:{type:Object,required:!0}},emits:["close"],setup(s,{emit:n}){var u;const a=n,e=s,l=g(),o=p(((u=e.subject)==null?void 0:u.name)||""),c=p({});w(()=>e.subject,d=>{d&&(o.value=d.name)},{immediate:!0});const i=async()=>{c.value={};try{await l.update(e.subject.id,{name:o.value,category_id:e.subject.category_id}),a("close")}catch(d){d.response&&d.response.data&&d.response.data.errors&&(c.value=d.response.data.errors)}};return(d,h)=>(r(),_("div",ae,[t("div",oe,[ce,t("form",{onSubmit:L(i,["prevent"]),class:"space-y-2"},[N(t("input",{class:"input-1","onUpdate:modelValue":h[0]||(h[0]=f=>o.value=f),placeholder:"Subject name",required:""},null,512),[[q,o.value]]),c.value.name?(r(),_("div",ne,v(c.value.name[0]),1)):b("",!0),c.value.category_id?(r(),_("div",le,v(c.value.category_id[0]),1)):b("",!0),t("div",re,[de,t("button",{type:"button",onClick:h[1]||(h[1]=f=>a("close")),class:"btn-contrast"},"Cancel")])],32)])]))}},ue=C(ie,[["__scopeId","data-v-c7838ff7"]]),_e=s=>($("data-v-120931b0"),s=s(),k(),s),pe={key:0,class:"modal"},he={class:"modal-content space-y-2"},be=_e(()=>t("h2",null,"Delete Subject",-1)),ve={key:0,class:"text-red-500"},me={class:"flex gap-4"},ye={__name:"DeleteSubjectModal",props:{subject:{type:Object,required:!0,default:()=>({name:"",id:null})}},emits:["close"],setup(s,{emit:n}){const a=n,e=s,l=g(),o=p({});w(()=>e.subject,i=>{},{immediate:!0});const c=async()=>{o.value={};try{await l.delete(e.subject.id),a("close")}catch(i){i.response&&i.response.data&&i.response.data.errors&&(o.value=i.response.data.errors)}};return(i,u)=>e.subject&&e.subject.name?(r(),_("div",pe,[t("div",he,[be,t("p",null,"Are you sure you want to delete the subject: "+v(e.subject.name)+"?",1),o.value.category_id?(r(),_("div",ve,v(o.value.category_id[0]),1)):b("",!0),t("div",me,[t("button",{onClick:c,class:"btn-2"},"Delete"),t("button",{type:"button",onClick:u[0]||(u[0]=d=>a("close")),class:"btn-contrast"},"Cancel")])])])):b("",!0)}},fe=C(ye,[["__scopeId","data-v-120931b0"]]),je={class:"my-container space-y-2"},ge={class:"flex gap-2"},Se=t("div",null," Category Name ",-1),xe=t("h4",{class:"title-lg"},"Subject List",-1),$e={key:0,class:"flex justify-center items-center"},ke=t("div",{class:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-gray-900"},null,-1),we=[ke],Ce={key:1},Me={key:0,class:"grid md:grid-cols-3 gap-4"},Ie={class:"flex flex-col items-center"},Ae=t("i",{class:"fad fa-folder text-4xl"},null,-1),De={class:"title-md"},Ee={class:"absolute top-4 right-4 flex gap-2"},Le=["onClick"],Ne=t("i",{class:"fad fa-edit"},null,-1),qe=[Ne],Ve=["onClick"],Be=t("i",{class:"fad fa-trash"},null,-1),ze=[Be],Re={key:1,class:"text-red-500"},Ue={__name:"SubjectList",setup(s){const n=U(),a=p(n.params.id),e=g(),l=p(!1),o=p(!1),c=p(!1),i=p(null),u=p(!0),d=()=>l.value=!0,h=()=>l.value=!1,f=m=>{i.value=m,o.value=!0},z=()=>o.value=!1,R=m=>{i.value=m,c.value=!0},F=()=>c.value=!1,M=async()=>{try{u.value=!0,await e.index(a.value)}finally{u.value=!1}};return H(M),w(()=>n.params.id,async m=>{a.value=m,await M()}),(m,Fe)=>{const I=Q("RouterLink");return r(),_("div",je,[t("div",ge,[A(I,{to:{name:"QuestionBank"}},{default:D(()=>[S("Category List")]),_:1}),S(" / "),Se]),t("div",{class:"flex justify-between"},[xe,t("button",{class:"btn-2",onClick:d},"Add Subject")]),u.value?(r(),_("div",$e,we)):(r(),_("div",Ce,[E(e).subjects.length?(r(),_("div",Me,[(r(!0),_(G,null,J(E(e).subjects,y=>(r(),_("div",{key:y.id,class:"relative card-bg items-center p-4"},[t("div",Ie,[Ae,t("p",De,v(y.name),1)]),t("div",Ee,[t("button",{onClick:O=>f(y)},qe,8,Le),t("button",{onClick:O=>R(y),class:"text-red-500"},ze,8,Ve)]),A(I,{to:{name:"ChapterList",params:{id:y.id}},class:"btn-link"},{default:D(()=>[S(" See Chapters ")]),_:2},1032,["to"])]))),128))])):(r(),_("p",Re,"No subjects found"))])),l.value?(r(),x(se,{key:2,class:"z-40",categoryId:a.value,onClose:h},null,8,["categoryId"])):b("",!0),o.value?(r(),x(ue,{key:3,class:"z-40",subject:i.value,onClose:z},null,8,["subject"])):b("",!0),c.value?(r(),x(fe,{key:4,class:"z-40",subject:i.value,onClose:F},null,8,["subject"])):b("",!0)])}}};export{Ue as default};
