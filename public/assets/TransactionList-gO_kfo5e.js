import{J as R,K as W,u as X,r as u,o as Y,d as w,e as l,f as r,g as t,s as B,t as n,n as _,z as P,N as U,F as D,h as L,q as k,i as z,A as Z,x as S}from"./index-Bs9WCFvG.js";const ee=R("transaction",{state:()=>({transactions:[],error:null}),actions:{async fetchTransactions(j={}){var y,v;try{const o=await W.get("/transactions",{params:j});this.transactions=(o==null?void 0:o.data)??[]}catch(o){this.error=((v=(y=o==null?void 0:o.response)==null?void 0:y.data)==null?void 0:v.message)??"An error occurred"}}}}),te={class:"my-container mx-auto py-4"},se={class:"flex justify-between gap-4 flex-wrap"},ae={class:"flex justify-center items-center gap-4 text-gray-400"},oe={class:"flex flex-wrap items-center justify-between py-4 gap-4"},ne={class:"flex items-center rounded-lg overflow-hidden"},le={class:"flex items-center rounded-lg overflow-hidden"},re={key:0,class:"w-full md:w-80 flex justify-between items-center gap-2"},ue=["value"],ie={key:1,class:"w-full md:w-80 flex justify-between items-center gap-2"},ce=["value"],de={key:0,class:"flex justify-center items-center"},pe={key:1,class:"overflow-x-auto card-bg"},ve={class:"min-w-full divide-y divide-gray-400 text-sm"},xe={class:"bg-white divide-y divide-gray-200"},ye={class:"px-3 py-3 whitespace-nowrap"},he={class:"px-3 py-3 max-w-xs"},fe={class:"px-3 py-3 whitespace-nowrap"},ge={class:"px-3 py-3 whitespace-nowrap"},we={class:"px-3 py-3 whitespace-nowrap"},be={class:"px-3 py-3 whitespace-nowrap text-center"},me={class:"px-3 py-3 whitespace-nowrap text-right"},_e={class:"px-3 py-3 whitespace-nowrap text-right"},ke={class:"px-3 py-3 whitespace-nowrap text-center"},Ce={class:"flex justify-between mt-4"},Te=["disabled"],Me=["disabled"],Pe={key:2,class:"text-red-500 mt-4"},C=15,Le={__name:"TransactionList",setup(j){const y=ee(),v=X(),o=u([]),T=u(""),p=u(null),b=u(!0),i=u(1),c=u("month"),M=u(!0),x=u(""),h=u(""),N=u(!1),V=()=>S(new Date,"MMM-yyyy");x.value=V();const f=async()=>{if(c.value==="month"&&!x.value){p.value="Please select a month before fetching transactions.";return}if(c.value==="course"&&!h.value){p.value="Please select a course before fetching transactions.";return}b.value=!0,o.value=[],i.value=1,p.value="";const a={paid:M.value,...c.value==="month"?{month:x.value}:{},...c.value==="course"?{course:h.value}:{}};await y.fetchTransactions(a),o.value=y.transactions,b.value=!1};Y(async()=>{try{f()}catch(a){p.value=a}finally{b.value=!1}});const I=a=>{const e=new Date(a);return S(e,"dd-MMM-yyyy")},q=async()=>{N.value||(await v.fetchCourses(),N.value=!0)},A=async a=>{a.value=!0,f()},F=async a=>{c.value=a,p.value="",a==="course"?(await q(),h.value=""):(x.value=V(),f())},E=()=>{const a=[],e=new Date;for(;e>=new Date(2024,7);)a.push(S(e,"MMM-yyyy")),e.setMonth(e.getMonth()-1);return a},J=w(()=>E()),K=w(()=>[...o.value].sort((e,d)=>new Date(d.created_at)-new Date(e.created_at)).filter(e=>{const d=e.course.title.toLowerCase(),m=e.user.name.toLowerCase(),s=e.user.phone.toLowerCase(),g=T.value.toLowerCase();return d.includes(g)||m.includes(g)||s.includes(g)})),G=w(()=>{const a=(i.value-1)*C,e=a+C;return K.value.slice(a,e)}),$=w(()=>Math.ceil(K.value.length/C)),H=()=>{i.value<$.value&&i.value++},O=()=>{i.value>1&&i.value--},Q=w(()=>{let a=0;return o.value&&(a=o.value.reduce((e,d)=>d.paid_amount?e+parseFloat(d.paid_amount):e,0)),a});return(a,e)=>{var d,m;return l(),r("div",te,[t("div",se,[e[9]||(e[9]=t("h1",{class:"flex-1 text-2xl font-bold"},"Transaction List",-1)),t("div",ae,[t("div",null,[e[7]||(e[7]=B(" Total Transaction: ")),t("b",null,n(o.value.length),1)]),t("div",null,[e[8]||(e[8]=B(" Total Amount: ")),t("b",null,n(Q.value)+" TK",1)])])]),t("div",oe,[t("div",ne,[t("button",{type:"button",class:_(["px-4 py-2.5",M.value?"bg-sky-500 text-white":"bg-gray-300 text-black"]),onClick:e[0]||(e[0]=s=>A(!0))}," Paid ",2),t("button",{type:"button",class:_(["px-4 py-2.5",M.value?"bg-gray-300 text-black":"bg-sky-500 text-white"]),onClick:e[1]||(e[1]=s=>A(!1))}," Free ",2)]),t("div",le,[t("button",{type:"button",class:_(["px-4 py-2.5",c.value==="month"?"bg-sky-500 text-white":"bg-gray-300 text-black"]),onClick:e[2]||(e[2]=s=>F("month"))}," Month ",2),t("button",{type:"button",class:_(["px-4 py-2.5",c.value==="course"?"bg-sky-500 text-white":"bg-gray-300 text-black"]),onClick:e[3]||(e[3]=s=>F("course"))}," Course ",2)]),c.value==="month"?(l(),r("div",re,[e[10]||(e[10]=t("label",{class:"grow-0 shrink-0 text-gray-400"},"Month:",-1)),P(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>x.value=s),class:"input-1 grow shrink",onChange:f},[(l(!0),r(D,null,L(J.value,s=>(l(),r("option",{key:s,value:s},n(s),9,ue))),128))],544),[[U,x.value]])])):k("",!0),c.value==="course"?(l(),r("div",ie,[e[12]||(e[12]=t("label",{class:"grow-0 shrink-0 text-gray-400"},"Course:",-1)),P(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>h.value=s),class:"input-1 grow shrink",onChange:f},[e[11]||(e[11]=t("option",{value:"",disabled:""},"-- Select Course --",-1)),(m=(d=z(v))==null?void 0:d.courses)!=null&&m.length?(l(!0),r(D,{key:0},L(z(v).courses,s=>(l(),r("option",{key:s.id,value:s.id},n(s.title),9,ce))),128)):k("",!0)],544),[[U,h.value]])])):k("",!0),P(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>T.value=s),type:"text",placeholder:"Title, Name or Phone",class:"input-1 w-full md:w-80"},null,512),[[Z,T.value]])]),b.value?(l(),r("div",de,e[13]||(e[13]=[t("div",{class:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-gray-900"},null,-1)]))):(l(),r("div",pe,[t("table",ve,[e[14]||(e[14]=t("thead",{class:"bg-gray-200"},[t("tr",null,[t("th",{scope:"col",class:"px-3 py-3 text-left text-xs font-bold uppercase tracking-wider"}," SL "),t("th",{scope:"col",class:"px-3 py-3 text-left text-xs font-bold uppercase tracking-wider"}," Course Title "),t("th",{scope:"col",class:"px-3 py-3 text-left text-xs font-bold uppercase tracking-wider"}," Purchased by "),t("th",{scope:"col",class:"px-3 py-3 text-left text-xs font-bold uppercase tracking-wider"}," Phone "),t("th",{scope:"col",class:"px-3 py-3 text-left text-xs font-bold uppercase tracking-wider"}," Purchased on "),t("th",{scope:"col",class:"px-3 py-3 text-center text-xs font-bold uppercase tracking-wider"}," TrxID "),t("th",{scope:"col",class:"px-3 py-3 text-right text-xs font-bold uppercase tracking-wider"}," Amount "),t("th",{scope:"col",class:"px-3 py-3 text-right text-xs font-bold uppercase tracking-wider"}," Discount "),t("th",{scope:"col",class:"px-3 py-3 text-center text-xs font-bold uppercase tracking-wider"}," Coupon Code ")])],-1)),t("tbody",xe,[(l(!0),r(D,null,L(G.value,(s,g)=>(l(),r("tr",{key:s.id},[t("td",ye,n((i.value-1)*C+g+1),1),t("td",he,n(s.course.title),1),t("td",fe,n(s.user.name),1),t("td",ge,n(s.user.phone),1),t("td",we,n(I(s.created_at)),1),t("td",be,n(s.trx_id),1),t("td",me,n(s.paid_amount)+" TK",1),t("td",_e,n(s.discount_amount)+" TK ",1),t("td",ke,n(s.coupon_code),1)]))),128))])])])),t("div",Ce,[t("button",{onClick:O,disabled:i.value===1,class:"px-4 py-2 bg-gray-300 text-gray-700 rounded disabled:opacity-50"}," Previous ",8,Te),t("button",{onClick:H,disabled:i.value===$.value,class:"px-4 py-2 bg-gray-300 text-gray-700 rounded disabled:opacity-50"}," Next ",8,Me)]),p.value?(l(),r("p",Pe,n(p.value),1)):k("",!0)])}}};export{Le as default};
