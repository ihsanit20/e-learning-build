import{E as T,G as D,b as G,c as O,k as Y,u as J,l as K,r as d,o as Q,d as L,e as n,f as a,g as e,t as c,H as W,F as k,h as $,p as M,x as w,z as X,I as Z,n as x,q as ee}from"./index-DQIf5F5M.js";const te=T("courseProgress",{state:()=>({userId:null}),actions:{async completeLecture(p,_,r){try{return(await D.post(`/lectures/${_}/complete`,{course_id:p,is_completed:r})).data}catch(h){throw console.error("Error completing lecture:",h),h}},async getLectureCompletionStatus(p,_){try{return(await D.get(`/users/${p}/lectures/${_}/completion`)).data.is_completed}catch(r){throw console.error("Error fetching lecture completion status:",r),r}},setUserId(p){this.userId=p}}}),se={class:"my-container py-4"},oe={key:0,class:"error"},le={key:1,class:"grid md:grid-cols-3 gap-4"},ne={class:"md:col-span-2 space-y-4"},ae={class:"title-xl"},ce=e("hr",{class:"my-2"},null,-1),ie={class:"relative pt-1"},re={class:"flex mb-2 items-center justify-between"},de=e("div",null,[e("span",null,"Course Progress")],-1),ue={class:"text-right"},pe={class:"text-xs font-semibold inline-block text-sky-600"},_e={class:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-sky-200"},he=e("h2",{class:"title-lg"},"Modules",-1),me={class:"space-y-4"},ve=["onClick"],fe={class:"text-center border-2 rounded-md p-1.5"},xe=e("div",{class:"text-xs md:text-sm"},"Module",-1),ye={class:"flex-1"},ge={class:"line-clamp-1"},be={key:0},ke={class:""},we=["onClick"],Ce={class:"flex flex-col items-center justify-center border rounded-md p-2 gap-1"},Ee={class:"text-xs"},Se={key:0},Le={key:1},$e={class:"flex-1"},Me={class:"text-gray-500 text-xs line-clamp-1"},je={class:"flex items-center text-sm pt-2"},Ie=["id","checked","onChange","disabled"],Pe=["for"],ze=["onClick"],Ve=e("div",{class:"flex flex-col items-center justify-center border rounded-md p-2 gap-1"},[e("i",{class:"fas fa-file-alt"}),e("div",{class:"text-xs"},"Exam")],-1),Ae={class:"w-full"},De={class:"title-sm"},Ne={class:"flex justify-between gap-2 text-sm text-gray-400"},qe={class:"flex items-center gap-2"},Be=e("i",{class:"far fa-clock"},null,-1),Ue=e("span",null,"Duration:",-1),Fe={key:2},He={key:3,class:"fixed inset-0 flex items-center justify-center z-50"},Re=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75"},null,-1),Te={class:"card-bg items-center justify-center p-6 md:p-8 overflow-hidden transform transition-all sm:max-w-lg sm:w-full text-center mx-2"},Ge=e("h3",{class:"title-lg",id:"modal-title"},"Confirm Lecture Completion",-1),Oe={class:""},Ye={class:"text-red-500"},Je={class:"flex gap-4"},Ke={class:"modal-content !px-3 !py-4 !max-w-xl"},Qe={class:"w-full h-full flex flex-col justify-between items-center space-y-3 overflow-hidden"},We=e("div",{class:"sticky top-0 grow-0 shrink-0 w-full bg-white z-10"},[e("h3",{class:"title-lg text-center",id:"modal-title"},"সাবধান!! গুরুত্বপূর্ণ তথ্য সমূহ")],-1),Xe={class:"size-full grow shrink border-y py-4 overflow-y-auto scrollbar"},Ze={class:"w-full list-[square] space-y-3 list-outside pl-5"},et=e("li",null," Exam ওপেন করা (“Start Exam” বাটনে ক্লিক) মাত্র আপনার টাইমার চালু হয়ে যাবে। আপনি Exam থেকে বেরিয়ে গেলেও টাইমার চলতে থাকবে এবং টাইম শেষে সাবমিট করতে হবে। ",-1),tt=e("li",null," Exam দেয়ার সময়ে যদি কোনো কারনে কানেকশন লস হয়ে যায় এবং আপনার টাইম শেষ হয়ে যায় আর সাবমিট করতে না পারেন, তাহলে আর Exam দেয়ার সুযোগ পাবেন না। ",-1),st={class:"flex items-center gap-1 md:gap-2"},ot=e("span",{class:"pt-1 text-xs md:text-base"},"আমি পরীক্ষা শুরু করতে চাই",-1),nt={__name:"MyCourseDetails",setup(p){const _=G(),r=O(),h=Y(),j=J(),m=te(),I=K(),y=_.params.id,i=d(null),C=d(null),v=d([]),g=d(!1),b=d(!1),f=d(null),E=d(null),S=d(!1);Q(async()=>{try{await j.fetchPurchasedCourse(y),i.value=j.course;const t=h.user.id;m.userId||m.setUserId(t);for(const s of i.value.modules)for(const u of s.lectures)u.is_completed=await m.getLectureCompletionStatus(t,u.id)}catch(t){C.value=t.message||"An error occurred",t.response&&t.response.status===403&&r.push("/")}});const N=t=>{const s=v.value.indexOf(t);s===-1?v.value.push(t):v.value.splice(s,1)},q=t=>{t.type==="video"?(I.endedCallback=async()=>{const s=await m.completeLecture(y,t.id,!0);t.is_completed=s.is_completed},I.showPlayer(t.link)):window.open(t.link,"_blank")},B=t=>{E.value=t,b.value=!0},U=async()=>{if(f.value)try{await m.completeLecture(y,f.value.id,!0),f.value.is_completed=!0,g.value=!1}catch(t){console.error("Error confirming lecture completion:",t)}},F=t=>{f.value=t,g.value=!0},P=L(()=>i.value?i.value.modules.reduce((t,s)=>t+s.lectures.length,0):0),H=L(()=>i.value?i.value.modules.reduce((t,s)=>t+s.lectures.filter(u=>u.is_completed).length,0):0),z=L(()=>P.value?H.value/P.value*100:0),R=async()=>{r.push({path:`/my/course/${y}/exam/${E.value.id}`})};return(t,s)=>{var u,V;return n(),a(k,null,[e("div",se,[C.value?(n(),a("div",oe,c(C.value),1)):i.value?(n(),a("div",le,[e("div",ne,[e("div",null,[e("h1",ae,c(i.value.title),1),ce]),e("div",null,[e("div",ie,[e("div",re,[de,e("div",ue,[e("span",pe,c(Math.round(z.value))+"% ",1)])]),e("div",_e,[e("div",{style:W({width:z.value+"%"}),class:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-sky-600"},null,4)])])]),he,e("ul",me,[(n(!0),a(k,null,$(i.value.modules,l=>(n(),a("li",{class:"card-bg p-4",key:l.id},[e("div",{onClick:o=>N(l.id),class:"flex flex-1 items-center gap-4 cursor-pointer"},[e("div",fe,[e("div",{class:x(["text-xl font-bold text-orange-500",{"!text-gray-400":l.is_active==0}])},c(l.order),3),xe]),e("div",ye,[e("h4",{class:x(["title-md",{"text-gray-400":l.is_active==0}])},c(l.title),3),e("p",ge,c(l.description),1)]),e("button",null,[e("i",{class:x(v.value.includes(l.id)?"fas fa-angle-up":"fas fa-angle-down")},null,2)])],8,ve),v.value.includes(l.id)?(n(),a("div",be,[e("ul",ke,[(n(!0),a(k,null,$(l.lectures,o=>(n(),a("li",{class:"pt-6",key:o.id},[e("a",{onClick:w(A=>q(o),["prevent"]),class:"flex items-center gap-4 bg-gray-100 hover:bg-sky-100 p-2 rounded-md cursor-pointer"},[e("div",Ce,[e("i",{class:x(o.type==="virtual_platform"?"fas fa-video":"fas fa-play-circle")},null,2),e("div",Ee,[o.type==="virtual_platform"?(n(),a("p",Se,"Video")):(n(),a("p",Le,"Lecture"))])]),e("div",$e,[e("h4",null,c(o.title),1),e("p",Me,c(o.description),1)])],8,we),e("div",je,[e("input",{type:"checkbox",id:`completed-${o.id}`,class:"form-checkbox h-3 w-3 text-sky-600 transition duration-150 ease-in-out",checked:o.is_completed,onChange:A=>F(o),disabled:o.is_completed},null,40,Ie),e("label",{for:`completed-${o.id}`,class:"ml-2"}," Have you completed this lecture? ",8,Pe)])]))),128)),(n(!0),a(k,null,$(l.exams,o=>(n(),a("li",{class:"pt-6",key:o.id},[e("a",{onClick:w(A=>B(o),["prevent"]),class:"flex items-center gap-4 bg-gray-100 hover:bg-sky-100 p-2 rounded-md cursor-pointer"},[Ve,e("div",Ae,[e("h4",De,c(o.title),1),e("div",Ne,[e("div",qe,[Be,e("p",null,[Ue,ee(" "+c(o.duration),1)])])])])],8,ze)]))),128))])])):M("",!0)]))),128))])])])):(n(),a("div",Fe,"Loading...")),g.value?(n(),a("div",He,[Re,e("div",Te,[Ge,e("div",Oe,[e("p",Ye,' Are you sure you have completed the lecture "'+c((u=f.value)==null?void 0:u.title)+'"? ',1)]),e("div",Je,[e("button",{onClick:U,type:"button",class:"btn-2"},"Yes"),e("button",{onClick:s[0]||(s[0]=l=>g.value=!1),type:"button",class:"btn-3"},"No")])])])):M("",!0)]),b.value?(n(),a("div",{key:0,class:"modal",onClick:s[3]||(s[3]=w(l=>b.value=!1,["self"]))},[e("div",Ke,[e("div",Qe,[We,e("div",Xe,[e("ul",Ze,[e("li",null," Exam এর সময়সীমা থাকবে "+c((V=E.value)==null?void 0:V.duration)+" মিনিট। এই সময়ের মধ্যে আপনাকে Exam সাবমিট করতে হবে। ",1),et,tt])]),e("form",{onSubmit:w(R,["prevent"]),class:"grow-0 shrink-0 w-full flex justify-end gap-1 md:gap-4"},[e("button",{onClick:s[1]||(s[1]=l=>b.value=!1),type:"button",class:"mr-auto btn-contrast px-1 md:px-4 text-xs md:text-base"}," Cancel "),e("label",st,[X(e("input",{"onUpdate:modelValue":s[2]||(s[2]=l=>S.value=l),type:"checkbox",required:""},null,512),[[Z,S.value]]),ot]),e("button",{type:"submit",class:x(["btn-2 disabled:opacity-50 px-1 md:px-4 text-xs md:text-base",{"opacity-50":!S.value}])}," Start Exam ",2)],32)])])])):M("",!0)],64)}}};export{nt as default};
