import{J as k,r as w,K as b,ac as I,c as L,d as c,i as s,e,t as g,q as x,p as f,g as h,o as S,F as $,f as T,j as M}from"./index-BXpgum4r.js";const C=k("software-charge",()=>{const n=w(null),i=w([]),a=w([]),d=w(!1),u=r=>{const[l,o]=r.split("-").map(Number);return`${r}-${new Date(l,o,0).getDate()}`};return{error:n,isLoaded:d,payments:i,monthWiseTotalIncome:a,fetchMonthlyTotalIncome:async r=>{var o,m;const l={from:`${r}-01`,to:u(r)};try{const{data:y}=await b.get("/total-income",{params:l});return Number((y==null?void 0:y.total_income)??0).toFixed(2)}catch(y){throw n.value=((m=(o=y==null?void 0:y.response)==null?void 0:o.data)==null?void 0:m.message)??"An error occurred",n.value}},fetchMonthWiseTotalIncome:async()=>{var r,l;try{const{data:o}=await b.get("/month-wise-total-income");a.value=o}catch(o){throw n.value=((l=(r=o==null?void 0:o.response)==null?void 0:r.data)==null?void 0:l.message)??"An error occurred",n.value}},fetchPaidHistory:async()=>{var l,o;const r="https://ihsanit.com";try{const{data:m}=await I.get(`${r}/api/software-charges/paid/history`,{headers:{"Content-Type":"application/json"}});return d.value=!0,i.value=m,m}catch(m){throw n.value=((o=(l=m==null?void 0:m.response)==null?void 0:l.data)==null?void 0:o.message)??"An error occurred",n.value}},paymentSoftwareCharge:async(r,l)=>{const o="https://ihsanit.com";return window.location=`${o}/software-charges/payment/${r}/${l}`}}}),j={class:"border px-4 py-2"},A={class:"border px-4 py-2"},N={class:"w-full flex gap-1 justify-between"},P={class:"border px-4 py-2"},D={class:"w-full flex gap-1 justify-between"},F={class:"border px-4 py-2"},W={key:0,class:"text-center animate-pulse"},B={key:1,class:"w-full flex gap-1 justify-between"},H={class:"border px-4 py-2"},R={key:0,class:"text-center animate-pulse"},U={key:1,class:"w-full flex gap-1 justify-between"},V={class:"border px-4 py-2"},q={key:0,class:"text-center animate-pulse"},E={key:1,class:"flex justify-center items-center gap-4"},J={__name:"MonthlyTableRow",props:["monthIncome","percentage"],setup(n){const i=n,a=C(),d=L(()=>(i.monthIncome.total_income*i.percentage*.01).toFixed(0)),u=L(()=>{var t;return((t=a.payments)==null?void 0:t.filter(v=>v.month===i.monthIncome.month)).reduce((v,_)=>v+Number(_.paid_amount),0).toFixed(0)});return(p,t)=>(s(),c("tr",null,[e("td",j,g(new Date(n.monthIncome.month+"-01").toLocaleString("default",{month:"short",year:"numeric"}).toUpperCase()),1),e("td",A,[e("div",N,[t[1]||(t[1]=e("span",null,"৳",-1)),x(" "+g(n.monthIncome.total_income),1)])]),e("td",P,[e("div",D,[t[2]||(t[2]=e("span",null,"৳",-1)),x(" "+g(d.value),1)])]),e("td",F,[h(a).isLoaded?f("",!0):(s(),c("div",W,"Loading...")),h(a).isLoaded&&u.value>0?(s(),c("div",B,[t[3]||(t[3]=e("span",null,"৳",-1)),x(" "+g(u.value),1)])):f("",!0)]),e("td",H,[h(a).isLoaded?f("",!0):(s(),c("div",R,"Loading...")),h(a).isLoaded&&d.value-u.value>0?(s(),c("div",U,[t[4]||(t[4]=e("span",null,"৳",-1)),x(" "+g((d.value-u.value).toFixed(0)),1)])):f("",!0)]),e("td",V,[h(a).isLoaded?f("",!0):(s(),c("div",q,"Loading...")),h(a).isLoaded&&d.value-u.value>0?(s(),c("div",E,[e("button",{onClick:t[0]||(t[0]=v=>h(a).paymentSoftwareCharge(p.month,d.value-u.value)),class:"btn-3"}," Pay Charge ")])):f("",!0)])]))}},K={class:"my-container space-y-4"},O={key:0,class:"text-center mt-2"},z={key:1,class:"text-red-500 text-center mb-4"},G={key:2,class:"w-full table table-auto text-center"},X={__name:"SoftwareCharge",setup(n){const i=C(),a=w(null),d=w(!1);return S(async()=>{await i.fetchMonthWiseTotalIncome(),await i.fetchPaidHistory()}),(u,p)=>(s(),c("div",K,[p[1]||(p[1]=e("h1",{class:"text-3xl font-bold mb-6 text-center"},"Software Charge",-1)),d.value?(s(),c("div",O,"Loading...")):a.value?(s(),c("div",z,g(a.value),1)):(s(),c("table",G,[p[0]||(p[0]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border px-4 py-2"},"Month"),e("th",{class:"border px-4 py-2"},"Total Transaction"),e("th",{class:"border px-4 py-2"},"Software Charge"),e("th",{class:"border px-4 py-2"},"Paid Amount"),e("th",{class:"border px-4 py-2"},"Due Amount"),e("th",{class:"border px-4 py-2"},"Action")])],-1)),e("tbody",null,[(s(!0),c($,null,T(h(i).monthWiseTotalIncome,t=>(s(),M(J,{key:t.month,monthIncome:t,percentage:5},null,8,["monthIncome"]))),128))])]))]))}};export{X as default};
