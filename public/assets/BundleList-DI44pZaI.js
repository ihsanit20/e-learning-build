import{r as v,a2 as S,x as n,y as o,z as e,A as x,M as T,C as b,F as w,G as B,a4 as N,D as h,Q as L,I as U,H as V,L as C,Z as z,X as I,W as F}from"./vue-CcEtAIOs.js";import{u as k}from"./index-Co5G-AfD.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-PJuFQbji.js";const R=["src"],K={class:"bg-white rounded-md p-4 w-96 relative"},q=["src"],A=["disabled"],E={key:0,class:"text-green-600 mt-2"},H={key:1,class:"text-red-600 mt-2"},P={__name:"ThumbnailUploader",props:{bundleId:{type:[Number,String],required:!0},initialThumbnail:{type:String,default:"/default-thumbnail.jpg"}},emits:["uploaded"],setup(d,{emit:p}){const l=d,a=p,r=k(),i=v(l.initialThumbnail),c=v(null),u=v(""),m=v(""),y=v(!1),_=v(!1);S(()=>l.initialThumbnail,f=>{i.value=f});const $=f=>{const t=f.target.files[0];t&&(t.size>2*1024*1024?(u.value="File should be less than 2MB",c.value=null):(c.value=t,u.value="",i.value=URL.createObjectURL(t)))},j=async()=>{if(!c.value)return;const f=new FormData;f.append("thumbnail",c.value),y.value=!0;try{await r.uploadThumbnail(l.bundleId,f),m.value="Thumbnail uploaded successfully!",c.value=null,a("uploaded")}catch(t){u.value=(t==null?void 0:t.message)??"Upload failed"}finally{y.value=!1}},g=()=>{_.value=!0},s=()=>{_.value=!1};return(f,t)=>(o(),n("div",null,[e("img",{class:"aspect-video object-cover rounded-md border overflow-hidden cursor-pointer",src:i.value,alt:"Thumbnail",onClick:g},null,8,R),t[1]||(t[1]=e("p",{class:"text-xs md:text-sm text-center mt-1"},"Click on the image to view or change.",-1)),_.value?(o(),n("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:T(s,["self"])},[e("div",K,[e("button",{onClick:s,class:"absolute top-2 right-2 text-gray-600 hover:text-gray-900 text-xl"}," Ã— "),t[0]||(t[0]=e("h3",{class:"text-lg font-bold mb-2"},"Upload Thumbnail",-1)),e("img",{class:"aspect-video object-cover rounded-md border mb-4 w-full",src:i.value,alt:"Preview"},null,8,q),e("input",{type:"file",onChange:$,class:"input-1 py-1 w-full mb-2",accept:"image/*"},null,32),e("button",{onClick:j,class:"btn-2 w-full",disabled:y.value||!c.value},b(y.value?"Uploading...":"Upload"),9,A),m.value?(o(),n("p",E,b(m.value),1)):x("",!0),u.value?(o(),n("p",H,b(u.value),1)):x("",!0)])])):x("",!0)]))}},X=M(P,[["__scopeId","data-v-80c46c07"]]),G={key:0,class:"modal"},Q={__name:"BundleDeleteModal",props:{isOpen:Boolean,bundle:Object},emits:["close","confirmDelete"],setup(d,{emit:p}){const l=d,a=p,r=k(),i=async()=>{l.bundle&&(await r.deleteBundle(l.bundle.id),a("confirmDelete"),a("close"))},c=()=>{a("close")};return(u,m)=>d.isOpen?(o(),n("div",G,[e("div",{class:"modal-content card-bg p-4 md:p-8"},[m[0]||(m[0]=e("h2",{class:"title-md text-red-600 text-center"},"Confirm Delete",-1)),m[1]||(m[1]=e("p",{class:"text-center"},"Are you sure you want to delete this bundle?",-1)),e("div",{class:"flex space-x-4 justify-center"},[e("button",{class:"btn-contrast",onClick:i},"Yes"),e("button",{class:"btn-2",onClick:c},"No")])])])):x("",!0)}},W={class:"text-xs md:text-base w-full border-collapse border border-gray-300"},Y={class:"border border-gray-300 px-2 text-center"},Z={class:"border border-gray-300 px-2"},J={class:"line-clamp-2"},ee={class:"border border-gray-300 px-2 text-right"},te={class:"border border-gray-300 px-2 text-right"},se={class:"bg-gray-100 font-bold"},le={class:"border border-gray-300 px-2 text-right"},ne={class:"border border-gray-300 px-2 text-right"},D={__name:"BundleCourseTable",props:{bundle:{type:Object,required:!0}},setup(d){return(p,l)=>(o(),n("table",W,[l[1]||(l[1]=e("thead",null,[e("tr",{class:"bg-gray-100"},[e("th",{class:"border border-gray-300 px-2 text-center"},"ID"),e("th",{class:"border border-gray-300 px-2 text-left"},"Course Title"),e("th",{class:"border border-gray-300 px-2 text-center md:w-32"},"Course Price"),e("th",{class:"border border-gray-300 px-2 text-center md:w-32"},"Bundle Price")])],-1)),e("tbody",null,[(o(!0),n(w,null,B(d.bundle.bundle_courses,a=>{var r,i;return o(),n("tr",{key:a.id},[e("td",Y,b(a.course_id),1),e("td",Z,[e("div",J,b(((r=a.course)==null?void 0:r.title)||"-"),1)]),e("td",ee,b(((i=a.course)==null?void 0:i.price)??"-")+" TK ",1),e("td",te,b(a.course_price??"-")+" TK ",1)])}),128))]),e("tfoot",null,[e("tr",se,[l[0]||(l[0]=e("td",{colspan:"2",class:"border border-gray-300 px-2 text-right"},"Total",-1)),e("td",le,b(d.bundle.bundle_courses.reduce((a,r)=>{var i;return a+Number(((i=r.course)==null?void 0:i.price)||0)},0))+" TK ",1),e("td",ne,b(d.bundle.bundle_courses.reduce((a,r)=>a+Number(r.course_price||0),0))+" TK ",1)])])]))}},oe={class:"card-bg md:py-4 p-4 md:p-2 grid md:grid-cols-3 lg:grid-cols-4 md:divide-x-2"},de={class:"md:col-span-1 px-2 content-center"},ae=["src","alt"],ie={key:0,class:"flex justify-center items-center pt-2"},re={class:"md:col-span-2 lg:col-span-3 md:px-4 space-y-2 flex flex-col justify-evenly"},ce={class:"flex justify-start items-center w-full gap-3"},ue={class:"shrink-0 text-xl font-semibold size-9 flex justify-center items-center border pt-1 rounded-xl"},pe={class:"title-md"},be={__name:"BundleItem",props:{bundle:{type:Object,required:!0},showSlotButton:{type:Boolean,default:!0}},setup(d){return(p,l)=>(o(),n("div",oe,[e("div",de,[e("div",null,[e("img",{class:"aspect-video object-cover rounded-md border overflow-hidden cursor-pointer",src:d.bundle.thumbnail||"/bundle.jpg",alt:d.bundle.title||"Thumbnail"},null,8,ae),d.showSlotButton?(o(),n("div",ie,[N(p.$slots,"default",{},()=>[l[0]||(l[0]=e("button",{type:"button",class:"btn-contrast"},"See Details",-1))])])):x("",!0)])]),e("div",re,[e("div",ce,[e("span",ue,b(d.bundle.id),1),e("h2",pe,b(d.bundle.title),1)]),h(D,{bundle:d.bundle},null,8,["bundle"])])]))}},me={class:"relative card-bg p-4 md:p-8 max-w-4xl max-h-[80%] overflow-y-auto"},ve=["innerHTML"],fe={__name:"BundleViewModal",props:{bundle:Object,isOpen:Boolean},emits:["close"],setup(d,{emit:p}){const l=d,a=k(),r=p,i=L(()=>a.bundles.find(u=>u.id===l.bundle.id)),c=()=>{r("close")};return(u,m)=>d.isOpen?(o(),n("div",{key:0,class:"modal",onClick:T(c,["self"])},[e("div",me,[e("div",{class:"flex top-2 right-2 z-50 absolute"},[e("button",{class:"bg-red-500 px-2 rounded-full text-white",onClick:c},"X")]),e("div",null,[h(be,{bundle:i.value,showSlotButton:!1},null,8,["bundle"])]),e("div",{innerHTML:i.value.description,class:"bg-white p-4 rounded-lg border *:mb-2.5 text-justify text-sm md:text-base"},null,8,ve)])])):x("",!0)}},xe=M(fe,[["__scopeId","data-v-ca5e79f4"]]),ge={class:"my-container space-y-2 relative"},he={class:"flex justify-between items-center"},ye={key:0,class:"space-y-2"},_e={key:1},we={key:0,class:"text-center"},ke={key:1,class:"space-y-2"},$e={key:0,class:"card-bg md:py-4 p-4 md:p-2 grid md:grid-cols-3 lg:grid-cols-4 md:divide-x-2"},je={class:"md:col-span-1 px-2 content-center"},Be={class:"md:col-span-2 lg:col-span-3 md:px-4 space-y-2 flex flex-col justify-between"},Ce={class:"flex justify-start items-center w-full gap-3"},Te={class:"shrink-0 text-xl font-semibold size-9 flex justify-center items-center border pt-1 rounded-xl"},Me={class:"title-md"},De={class:"flex flex-wrap gap-4 items-center justify-between"},Oe={class:"flex justify-start items-center gap-2"},Se={class:"flex justify-end items-center gap-2"},Ne=["onClick"],Le=["onClick"],Fe={__name:"BundleList",setup(d){const p=k(),l=v([]),a=v(!1),r=v(null),i=v(!1),c=v(!1),u=v(!0),m=async()=>{u.value=!0,await p.fetchBundles(),l.value=p.bundles.sort((g,s)=>s.id-g.id),u.value=!1};U(async()=>{await m()});const y=g=>{r.value=g,i.value=!0},_=g=>{r.value=g,c.value=!0},$=async()=>{await p.deleteBundle(r.value.id),l.value=p.bundles},j=()=>{alert("Thumbnail successfully uploaded!")};return(g,s)=>{const f=z("RouterLink");return o(),n("div",ge,[e("div",he,[s[6]||(s[6]=e("h1",{class:"title-lg text-center"},"Bundles",-1)),e("div",{onClick:m,class:"bg-white border flex justify-center items-center gap-2 btn-4 cursor-pointer"},[e("i",{class:V(["fas fa-sync text-lg",{"animate-spin":u.value}])},null,2),s[3]||(s[3]=e("span",{class:"pt-1 hidden md:inline"},"Reload",-1))]),x("",!0),h(f,{class:"btn-2",to:{name:"NewBundle"}},{default:C(()=>s[5]||(s[5]=[I("Add New")])),_:1})]),u.value?(o(),n("div",ye,[(o(),n(w,null,B(3,t=>e("div",{key:t,class:"card-bg md:py-2 p-4 md:p-2 grid md:grid-cols-8 md:divide-x-2 animate-pulse"},s[7]||(s[7]=[F('<div class="md:col-span-1 rounded md:px-2"><div class="aspect-video bg-gray-200"></div></div><div class="md:col-span-3 md:px-2"><div class="h-6 bg-gray-200 rounded-full mb-2"></div><div class="h-4 bg-gray-200 rounded-full"></div></div><div class="md:col-span-1 flex items-center justify-center px-2"><div class="h-6 bg-gray-200 rounded-full w-20"></div></div><div class="md:col-span-3 flex justify-between items-center gap-2 md:px-2"><div class="h-10 bg-gray-200 rounded-full w-20"></div><div class="h-10 bg-gray-200 rounded-full w-20"></div><div class="h-10 bg-gray-200 rounded-full w-20"></div><div class="h-10 bg-gray-200 rounded-full w-20"></div></div>',4)]))),64))])):(o(),n("div",_e,[l.value.length===0?(o(),n("div",we,s[8]||(s[8]=[e("p",null,"No bundles available.",-1)]))):(o(),n("ul",ke,[(o(!0),n(w,null,B(l.value,t=>(o(),n(w,{key:t.id},[!a.value||t.is_active?(o(),n("li",$e,[e("div",je,[h(X,{"bundle-id":t.id,"initial-thumbnail":t.thumbnail,onUploaded:j},null,8,["bundle-id","initial-thumbnail"])]),e("div",Be,[e("div",Ce,[e("span",Te,b(t.id),1),e("h2",Me,b(t.title),1)]),h(D,{bundle:t},null,8,["bundle"]),e("div",De,[e("div",Oe,[x("",!0)]),e("div",Se,[e("button",{class:"btn-1 pb-1 pt-1.5 px-3",onClick:O=>y(t)},s[9]||(s[9]=[e("i",{class:"fas fa-eye"},null,-1),e("p",{class:"hidden md:flex"},"View",-1)]),8,Ne),h(f,{to:{name:"BundleEditForm",params:{id:t.id}},class:"btn-1 pb-1 pt-1.5 px-3"},{default:C(()=>s[10]||(s[10]=[e("i",{class:"far fa-edit"},null,-1),e("p",{class:"hidden md:flex"},"Edit",-1)])),_:2},1032,["to"]),(o(),n("button",{key:0,class:"btn-contrast pb-2",onClick:O=>_(t)},s[11]||(s[11]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,Le))])])])])):x("",!0)],64))),128))]))])),h(xe,{class:"absolute top-0 shadow-2xl w-full z-40",bundle:r.value,isOpen:i.value,onClose:s[1]||(s[1]=t=>i.value=!1)},null,8,["bundle","isOpen"]),h(Q,{class:"absolute top-0 shadow-2xl w-full z-40",bundle:r.value,isOpen:c.value,onClose:s[2]||(s[2]=t=>c.value=!1),onConfirmDelete:$},null,8,["bundle","isOpen"])])}}};export{Fe as default};
