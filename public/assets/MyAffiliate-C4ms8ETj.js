import{d as V,o as F,e as l,f as i,g as t,s as v,t as r,y as k,i as f,F as C,h as _,k as B,r as g,z as w,A as D,a3 as M,q as T,j as I}from"./index-CGxlq7hy.js";import{u as j}from"./coupon-CdrTD0zS.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"bg-white border rounded-lg w-full max-w-3xl p-4 max-h-[80vh]"},L={class:"flex justify-between items-center gap-2"},P={class:"mb-0"},Y={class:"border px-3 pt-2 pb-1 rounded-lg"},G={key:0},H={class:"text-right"},R={key:1,class:"flex justify-center items-center py-20 text-red-600"},J={__name:"CouponEarnListModal",props:{code:String,onClose:Function},setup(p){const c=p,d=j(),b=V(()=>{const m=d.userEarnings.reduce((s,a)=>s+parseInt(a.commission_amount),0);return parseInt(m)});return F(()=>{d.fetchUserEarnings({code:c.code})}),(m,s)=>{var a,x;return l(),i("div",{onClick:s[1]||(s[1]=k((...u)=>p.onClose&&p.onClose(...u),["self"])),class:"fixed inset-0 w-full h-full flex justify-center pt-16 bg-black/40 z-[99999999]"},[t("div",z,[t("div",L,[t("h2",P,[s[2]||(s[2]=v(" Earnings for Code: ")),t("b",Y,r(p.code),1)]),t("i",{onClick:s[0]||(s[0]=k((...u)=>p.onClose&&p.onClose(...u),["self"])),class:"fal fa-window-close text-3xl cursor-pointer text-red-500"})]),s[5]||(s[5]=t("hr",{class:"my-3"},null,-1)),(x=(a=f(d))==null?void 0:a.userEarnings)!=null&&x.length?(l(),i("div",G,[t("p",null,[s[3]||(s[3]=v(" Total Earnings: ")),t("strong",null,r(b.value)+" TK",1)]),t("table",null,[s[4]||(s[4]=t("thead",null,[t("tr",null,[t("th",null,"Date"),t("th",{class:"text-right"},"Amount")])],-1)),t("tbody",null,[(l(!0),i(C,null,_(f(d).userEarnings,u=>(l(),i("tr",{key:u.id},[t("td",null,r(u.date),1),t("td",null,[t("div",H,r(parseInt(u.commission_amount))+" TK",1)])]))),128))])])])):(l(),i("div",R," No earnings found for this promo code. "))])])}}},O=K(J,[["__scopeId","data-v-404b9a87"]]),Q={class:"max-w-4xl mx-auto p-4"},W={class:"py-4"},X={key:0},Z={class:"grid md:grid-cols-2 gap-4"},tt={class:"col-span-full"},et=["value"],ot={key:1,class:"py-4"},st={class:"flex flex-wrap items-center gap-3"},lt={class:"flex gap-3 items-center"},nt=["onClick"],it=["value"],at=["onClick"],rt={class:"ml-auto flex gap-3 items-center"},ut={class:"border px-3 pt-2 pb-1 rounded-lg text-sm md:text-base"},dt={class:"border px-3 pt-2 pb-1 rounded-lg text-sm md:text-base"},pt={key:1,class:"text-red-600 py-4 text-center"},vt={__name:"MyAffiliate",setup(p){const c=B(),d=j(),b=g(""),m=g(!1),s=g(!1),a=g({institute:"",session:"",group:""});F(()=>{d.fetchUserCoupons()});const x=n=>{n&&(b.value=n,m.value=!0)},u=async()=>{const n=await c.applyAffiliate({additional_info:a.value});c.user.affiliate_status=n==null?void 0:n.affiliate_status,c.user.additional_info=n==null?void 0:n.additional_info,s.value=!1},q=Array.from({length:51},(n,e)=>new Date().getFullYear()-e);function N(n){if(navigator.clipboard&&typeof navigator.clipboard.writeText=="function")navigator.clipboard.writeText(n).then(()=>alert("Promo code link copied to clipboard!")).catch(e=>console.error("Failed to copy: ",e));else{const e=document.createElement("input");e.value=n,document.body.appendChild(e),e.select();try{document.execCommand("copy"),alert("Promo code link copied to clipboard!")}catch(y){console.error("Fallback copy failed: ",y)}document.body.removeChild(e)}}return(n,e)=>{var y,h,S,A,$,E;return l(),i(C,null,[t("div",Q,[e[17]||(e[17]=t("h1",{class:"title-xl"},"My Affiliate",-1)),t("div",W,[e[5]||(e[5]=v(" Affiliate Status: ")),t("b",null,r(((h=(y=f(c))==null?void 0:y.user)==null?void 0:h.affiliate_status)??"N/A"),1)]),(A=(S=f(c))==null?void 0:S.user)!=null&&A.affiliate_status?(l(),i("div",ot,[e[16]||(e[16]=t("h2",{class:"text-xl font-semibold"},"Promo Codes",-1)),(E=($=f(d))==null?void 0:$.userCoupons)!=null&&E.length?(l(!0),i(C,{key:0},_(f(d).userCoupons,o=>(l(),i("div",{key:o.id,class:"bg-white p-3 rounded-lg mb-3"},[t("div",st,[t("div",lt,[t("button",{onClick:U=>x(o.code),class:"px-3 pt-2.5 pb-2 border rounded-lg btn-2",type:"button"}," Earnings ",8,nt),t("input",{class:"input-1 text-black w-40 text-center",type:"text",value:o.code,readonly:""},null,8,it),t("button",{class:"shrink-0 grow-0 border rounded-lg px-3 pt-2 pb-1.5",type:"button",onClick:U=>N(o.code)},e[15]||(e[15]=[t("i",{class:"far fa-copy"},null,-1)]),8,at)]),t("div",rt,[t("div",ut," Discount: "+r(o.discount_value)+r(o.discount_type==="percentage"?"%":"TK"),1),t("div",dt," Commission: "+r(o.commission_value)+r(o.discount_type==="percentage"?"%":"TK"),1)])])]))),128)):(l(),i("div",pt,"-- Coupon Code Not Found! --"))])):(l(),i("div",X,[t("button",{onClick:e[0]||(e[0]=o=>s.value=!0),type:"button",class:"btn-2"}," Request for Affiliate "),s.value?(l(),i("div",{key:0,onClick:e[4]||(e[4]=k(o=>s.value=!1,["self"])),class:"fixed inset-0 flex pt-16 justify-center w-full h-full bg-black/40 z-[999999]"},[t("form",{onSubmit:k(u,["prevent"]),class:"bg-white p-4 rounded-lg border w-full max-w-xl max-h-[80vh] overflow-y-auto mb-auto"},[e[11]||(e[11]=t("h3",{class:"text-xl font-semibold"},"Affiliate Form",-1)),e[12]||(e[12]=t("hr",{class:"my-3"},null,-1)),t("div",Z,[t("label",tt,[e[6]||(e[6]=v(" College / University ")),w(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.institute=o),type:"text",class:"input-1",required:""},null,512),[[D,a.value.institute]])]),t("label",null,[e[8]||(e[8]=v(" HSC Batch (Year) ")),w(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.session=o),class:"input-1 text-center",required:""},[e[7]||(e[7]=t("option",{value:""},"-- Select Year --",-1)),(l(!0),i(C,null,_(f(q),o=>(l(),i("option",{key:o,value:o},r(o),9,et))),128))],512),[[M,a.value.session]])]),t("label",null,[e[10]||(e[10]=v(" HSC Group ")),w(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.group=o),class:"input-1 text-center",required:""},e[9]||(e[9]=[t("option",{value:""},"-- Select Group --",-1),t("option",{value:"Science"},"Science",-1),t("option",{value:"Arts"},"Arts",-1),t("option",{value:"Commerce"},"Commerce",-1)]),512),[[M,a.value.group]])])]),e[13]||(e[13]=t("hr",{class:"my-3"},null,-1)),e[14]||(e[14]=t("div",{class:"flex justify-end items-center"},[t("button",{class:"btn-2",type:"submit"},"Submit")],-1))],32)])):T("",!0)]))]),m.value?(l(),I(O,{key:0,code:b.value,onClose:()=>m.value=!1},null,8,["code","onClose"])):T("",!0)],64)}}};export{vt as default};
