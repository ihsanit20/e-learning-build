import{u as L,r as l,c as S,o as N,d as n,e as t,z as i,N as C,A as x,F as k,f as P,g as p,q as V,t as o,i as r}from"./index-BXpgum4r.js";import{u as B}from"./transaction-CNGNmlf2.js";const M={class:"container mx-auto p-4"},j={class:"mb-4 flex md:flex-row flex-col gap-4"},O=["value"],R={class:"flex justify-center gap-4 text-sm"},X={class:"font-semibold"},q={class:"font-semibold"},z={class:"overflow-x-auto"},E={class:"min-w-full bg-white border border-gray-200 rounded-lg text-sm"},G={key:0},H={class:"py-0.5 px-2 border"},J={class:"py-0.5 px-2 border"},K={class:"py-0.5 px-2 border"},Q={class:"py-0.5 px-2 border"},W={class:"py-0.5 px-2 border"},Y={class:"py-0.5 px-2 border text-green-600 font-semibold"},Z={class:"py-0.5 px-2 border"},$={class:"py-0.5 px-2 border"},tt={key:2},et={class:"mt-4 flex justify-between"},st=["disabled"],ot=["disabled"],rt={__name:"TransactionList",setup(at){const a=B(),w=L(),v=l(new Date(new Date().setDate(new Date().getDate()-30)).toISOString().split("T")[0]),y=l(new Date().toISOString().split("T")[0]),c=l(1),_=l("paid"),f=l(""),m=l(""),g=l(""),h=l(!1),F=S(()=>{var u;return((u=a.transactions.data)==null?void 0:u.length)||0}),U=S(()=>{var u;return((u=a.transactions.data)==null?void 0:u.reduce((e,b)=>e+parseFloat(b.paid_amount),0))||0}),d=async()=>{h.value=!0,await a.fetchTransactions({from:v.value,to:y.value,page:c.value,status:_.value,course_id:f.value,trx_id:m.value,phone:g.value}),h.value=!1};N(async()=>{await d(),await w.fetchCourses()});const A=()=>{a.transactions.next_page_url&&(c.value++,d())},I=()=>{a.transactions.prev_page_url&&(c.value--,d())};return(u,e)=>{var b,D,T;return r(),n("div",M,[e[12]||(e[12]=t("h1",{class:"text-2xl font-bold mb-4"},"Transaction List",-1)),t("div",j,[i(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>_.value=s),onChange:d,class:"input-1 w-full"},e[6]||(e[6]=[t("option",{value:"all"},"All",-1),t("option",{value:"paid"},"Paid",-1),t("option",{value:"free"},"Free",-1)]),544),[[C,_.value]]),i(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>v.value=s),class:"input-1 w-full",placeholder:"From Date"},null,512),[[x,v.value]]),i(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>y.value=s),class:"input-1 w-full",placeholder:"To Date"},null,512),[[x,y.value]]),i(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>f.value=s),onChange:d,class:"input-1 w-full"},[e[7]||(e[7]=t("option",{value:""},"Select Course",-1)),(r(!0),n(k,null,P(p(w).courses,s=>(r(),n("option",{key:s.id,value:s.id},o(s.title),9,O))),128))],544),[[C,f.value]]),i(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=s=>m.value=s),class:"input-1 w-full",placeholder:"Search by TRX ID"},null,512),[[x,m.value]]),i(t("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=s=>g.value=s),class:"input-1 w-full",placeholder:"Search by Phone"},null,512),[[x,g.value]]),t("button",{onClick:d,class:"btn-2"},"Filter")]),t("div",R,[t("span",X,"Visible Data: "+o(F.value),1),e[8]||(e[8]=V(" || ")),t("span",q,"Total Amount: ৳ "+o(U.value.toFixed(2)),1)]),t("div",z,[t("table",E,[e[11]||(e[11]=t("thead",null,[t("tr",{class:"bg-gray-200 text-left"},[t("th",{class:"py-0.5 px-2 border"},"Date"),t("th",{class:"py-0.5 px-2 border"},"User"),t("th",{class:"py-0.5 px-2 border"},"Phone"),t("th",{class:"py-0.5 px-2 border"},"Course"),t("th",{class:"py-0.5 px-2 border"},"TRX ID"),t("th",{class:"py-0.5 px-2 border"},"Paid Amount"),t("th",{class:"py-0.5 px-2 border"},"Coupon Code"),t("th",{class:"py-0.5 px-2 border"},"Discount")])],-1)),t("tbody",null,[h.value?(r(),n("tr",G,e[9]||(e[9]=[t("td",{colspan:"8",class:"text-center py-4"},[t("span",{class:"loader"}),V(" Loading transactions... ")],-1)]))):((T=(D=(b=p(a))==null?void 0:b.transactions)==null?void 0:D.data)==null?void 0:T.length)>0?(r(!0),n(k,{key:1},P(p(a).transactions.data,s=>(r(),n("tr",{key:s.id,class:"border-b"},[t("td",H,o(s.date),1),t("td",J,o(s.user.name),1),t("td",K,o(s.user.phone),1),t("td",Q,o(s.course.title),1),t("td",W,o(s.trx_id),1),t("td",Y," ৳ "+o(s.paid_amount),1),t("td",Z,o(s.coupon_code),1),t("td",$,"৳ "+o(s.discount_amount),1)]))),128)):(r(),n("tr",tt,e[10]||(e[10]=[t("td",{colspan:"8",class:"text-center py-4"},"No transactions found",-1)])))])])]),t("div",et,[t("button",{onClick:I,disabled:!p(a).transactions.prev_page_url,class:"bg-gray-300 px-4 py-2 rounded disabled:opacity-50"}," Previous ",8,st),t("span",null,"Page "+o(c.value)+" of "+o(p(a).transactions.last_page),1),t("button",{onClick:A,disabled:!p(a).transactions.next_page_url,class:"bg-gray-300 px-4 py-2 rounded disabled:opacity-50"}," Next ",8,ot)])])}}};export{rt as default};
