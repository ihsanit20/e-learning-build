import{r as u,a2 as N,x as n,y as a,z as e,A as x,M as U,C as d,Q as L,X as M,I as z,D as $,H as S,L as O,Z as V,F as T,G as j,W as I}from"./vue-CcEtAIOs.js";import{u as D}from"./bundle-GV0SUa4l.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{f as E}from"./index-B8R8XCyq.js";import"./vendor-PJuFQbji.js";const R=["src"],A={class:"bg-white rounded-md p-4 w-96 relative"},P=["src"],H=["disabled"],X={key:0,class:"text-green-600 mt-2"},q={key:1,class:"text-red-600 mt-2"},G={__name:"ThumbnailUploader",props:{bundleId:{type:[Number,String],required:!0},initialThumbnail:{type:String,default:"/default-thumbnail.jpg"}},emits:["uploaded"],setup(h,{emit:y}){const c=h,g=y,m=D(),l=u(c.initialThumbnail),r=u(null),i=u(""),p=u(""),v=u(!1),_=u(!1);N(()=>c.initialThumbnail,b=>{l.value=b});const k=b=>{const s=b.target.files[0];s&&(s.size>2*1024*1024?(i.value="File should be less than 2MB",r.value=null):(r.value=s,i.value="",l.value=URL.createObjectURL(s)))},B=async()=>{if(!r.value)return;const b=new FormData;b.append("thumbnail",r.value),v.value=!0;try{await m.uploadThumbnail(c.bundleId,b),p.value="Thumbnail uploaded successfully!",r.value=null,g("uploaded")}catch(s){i.value=(s==null?void 0:s.message)??"Upload failed"}finally{v.value=!1}},o=()=>{_.value=!0},t=()=>{_.value=!1};return(b,s)=>(a(),n("div",null,[e("img",{class:"aspect-video object-cover rounded-md border overflow-hidden cursor-pointer",src:l.value,alt:"Thumbnail",onClick:o},null,8,R),s[1]||(s[1]=e("p",{class:"text-xs md:text-sm text-center mt-1"},"Click on the image to view or change.",-1)),_.value?(a(),n("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:U(t,["self"])},[e("div",A,[e("button",{onClick:t,class:"absolute top-2 right-2 text-gray-600 hover:text-gray-900 text-xl"}," × "),s[0]||(s[0]=e("h3",{class:"text-lg font-bold mb-2"},"Upload Thumbnail",-1)),e("img",{class:"aspect-video object-cover rounded-md border mb-4 w-full",src:l.value,alt:"Preview"},null,8,P),e("input",{type:"file",onChange:k,class:"input-1 py-1 w-full mb-2"},null,32),e("button",{onClick:B,class:"btn-2 w-full",disabled:v.value||!r.value},d(v.value?"Uploading...":"Upload"),9,H),p.value?(a(),n("p",X,d(p.value),1)):x("",!0),i.value?(a(),n("p",q,d(i.value),1)):x("",!0)])])):x("",!0)]))}},Q=F(G,[["__scopeId","data-v-1888c52f"]]),W={key:0,class:"modal"},Y={__name:"BundleDeleteModal",props:{isOpen:Boolean,bundle:Object},emits:["close","confirmDelete"],setup(h,{emit:y}){const c=h,g=y,m=D(),l=async()=>{c.bundle&&(await m.deleteBundle(c.bundle.id),g("confirmDelete"),g("close"))},r=()=>{g("close")};return(i,p)=>h.isOpen?(a(),n("div",W,[e("div",{class:"modal-content card-bg p-4 md:p-8"},[p[0]||(p[0]=e("h2",{class:"title-md text-red-600 text-center"},"Confirm Delete",-1)),p[1]||(p[1]=e("p",{class:"text-center"},"Are you sure you want to delete this bundle?",-1)),e("div",{class:"flex space-x-4 justify-center"},[e("button",{class:"btn-contrast",onClick:l},"Yes"),e("button",{class:"btn-2",onClick:r},"No")])])])):x("",!0)}},Z={key:0,class:"modal"},J={class:"relative card-bg p-4 md:p-8 max-w-3xl h-2/3"},K={class:"overflow-y-scroll scrollbar space-y-2 p-2 bg-gray-100 rounded-md"},ee=["src"],te={class:"flex w-full text-center gap-4"},se={class:"text-center text-green-600"},le={class:"text-center text-red-600"},ne={class:"title-md"},ae={class:"md:flex justify-between"},oe=["innerHTML"],de={key:0},ie={class:"font-bold text-sky-600"},re={class:""},ue={class:"title-sm"},ce={__name:"BundleViewModal",props:{bundle:Object,isOpen:Boolean},emits:["close"],setup(h,{emit:y}){const c=h,g=D(),m=y,l=L(()=>g.bundles.find(o=>o.id===c.bundle.id)),r=()=>{m("close")},i=u(null),p=u(""),v=u(""),_=o=>{const t=o.target.files[0];t&&t.size>2*1024*1024?(v.value="File should be less than 2MB",i.value=null,document.getElementById("file-input").value=""):(i.value=t,v.value="")},k=async()=>{if(!i.value)return;const o=new FormData;o.append("thumbnail",i.value);try{await g.uploadThumbnail(c.bundle.id,o),p.value="Thumbnail uploaded successfully!",i.value=null,document.getElementById("file-input").value=""}catch{v.value="An error occurred while uploading the thumbnail"}},B=o=>E(new Date(o),"dd-MMM-yyyy");return(o,t)=>{var b,s;return h.isOpen?(a(),n("div",Z,[e("div",J,[e("div",{class:"flex top-2 right-2 z-50 absolute"},[e("button",{class:"bg-red-500 px-2 rounded-full text-white",onClick:r},"X")]),e("div",K,[e("img",{class:"aspect-video object-cover rounded-lg",src:l.value.thumbnail,alt:"Thumbnail"},null,8,ee),t[5]||(t[5]=e("p",{class:"text-sm"}," **File size should be less than 2MB and aspect ratio 9:16 (720px x 1280px)** ",-1)),e("div",te,[e("input",{id:"file-input",type:"file",onChange:_,class:"input-1"},null,32),e("button",{class:"btn-1",onClick:k},"Upload")]),e("p",se,d(p.value),1),e("p",le,d(v.value),1),e("h2",ne,d(l.value.title),1),e("div",ae,[e("p",null,[t[0]||(t[0]=M(" Bundle Category: ")),e("b",null,d((s=(b=l.value)==null?void 0:b.category)==null?void 0:s.name),1)]),e("p",null,[t[1]||(t[1]=M(" Bundle Type: ")),e("b",null,d(l.value.bundle_type),1)])]),e("div",null,[t[2]||(t[2]=e("b",null,"Bundle Description:",-1)),e("div",{innerHTML:l.value.description,class:""},null,8,oe)]),l.value.bundle_type==="Live Bundle"?(a(),n("p",de,[t[3]||(t[3]=M(" Start Date: ")),e("span",ie,d(B(l.value.start_date)),1)])):x("",!0),e("p",re,[t[4]||(t[4]=M(" Price: ৳ ")),e("span",ue,d(l.value.price),1)])]),e("div",null,[e("button",{class:"btn-contrast",onClick:r},"Close")])])])):x("",!0)}}},pe=F(ce,[["__scopeId","data-v-1f060b29"]]),be={class:"my-container space-y-2 relative"},me={class:"flex justify-between items-center"},ve={key:0,class:"space-y-2"},fe={key:1},ye={key:0,class:"text-center"},ge={key:1,class:"space-y-2"},xe={key:0,class:"card-bg md:py-4 p-4 md:p-2 grid md:grid-cols-4 md:divide-x-2"},he={class:"md:col-span-1 px-2 content-center"},_e={class:"md:col-span-3 md:px-4 space-y-2 flex flex-col justify-between"},we={class:"flex justify-start items-center w-full gap-3"},ke={class:"shrink-0 text-xl font-semibold size-9 flex justify-center items-center border pt-1 rounded-xl"},Be={class:"title-md"},Ce={class:"w-full border-collapse border border-gray-300"},$e={class:"border border-gray-300 px-2 text-center"},Me={class:"border border-gray-300 px-2"},Te={class:"line-clamp-1"},De={class:"border border-gray-300 px-2 text-right"},je={class:"border border-gray-300 px-2 text-right"},Oe={class:"bg-gray-100 font-bold"},Fe={class:"border border-gray-300 px-2 text-right"},Ne={class:"border border-gray-300 px-2 text-right"},Ue={class:"flex flex-wrap gap-4 items-center justify-between"},Le={class:"flex justify-start items-center gap-2"},ze={class:"flex justify-end items-center gap-2"},Se=["onClick"],Ve=["onClick"],He={__name:"BundleList",setup(h){const y=D(),c=u([]),g=u(!1),m=u(null),l=u(!1),r=u(!1),i=u(!0),p=async()=>{i.value=!0,await y.fetchBundles(),c.value=y.bundles.sort((o,t)=>t.id-o.id),i.value=!1};z(async()=>{await p()});const v=o=>{m.value=o,l.value=!0},_=o=>{m.value=o,r.value=!0},k=async()=>{await y.deleteBundle(m.value.id),c.value=y.bundles},B=()=>{alert("Thumbnail successfully uploaded!")};return(o,t)=>{const b=V("RouterLink");return a(),n("div",be,[e("div",me,[t[6]||(t[6]=e("h1",{class:"title-lg text-center"},"Bundles",-1)),e("div",{onClick:p,class:"bg-white border flex justify-center items-center gap-2 btn-4 cursor-pointer"},[e("i",{class:S(["fas fa-sync text-lg",{"animate-spin":i.value}])},null,2),t[3]||(t[3]=e("span",{class:"pt-1 hidden md:inline"},"Reload",-1))]),x("",!0),$(b,{class:"btn-2",to:{name:"NewBundle"}},{default:O(()=>t[5]||(t[5]=[M("Add New")])),_:1})]),i.value?(a(),n("div",ve,[(a(),n(T,null,j(3,s=>e("div",{key:s,class:"card-bg md:py-2 p-4 md:p-2 grid md:grid-cols-8 md:divide-x-2 animate-pulse"},t[7]||(t[7]=[I('<div class="md:col-span-1 rounded md:px-2"><div class="aspect-video bg-gray-200"></div></div><div class="md:col-span-3 md:px-2"><div class="h-6 bg-gray-200 rounded-full mb-2"></div><div class="h-4 bg-gray-200 rounded-full"></div></div><div class="md:col-span-1 flex items-center justify-center px-2"><div class="h-6 bg-gray-200 rounded-full w-20"></div></div><div class="md:col-span-3 flex justify-between items-center gap-2 md:px-2"><div class="h-10 bg-gray-200 rounded-full w-20"></div><div class="h-10 bg-gray-200 rounded-full w-20"></div><div class="h-10 bg-gray-200 rounded-full w-20"></div><div class="h-10 bg-gray-200 rounded-full w-20"></div></div>',4)]))),64))])):(a(),n("div",fe,[c.value.length===0?(a(),n("div",ye,t[8]||(t[8]=[e("p",null,"No bundles available.",-1)]))):(a(),n("ul",ge,[(a(!0),n(T,null,j(c.value,s=>(a(),n(T,{key:s.id},[!g.value||s.is_active?(a(),n("li",xe,[e("div",he,[$(Q,{"bundle-id":s.id,"initial-thumbnail":s.thumbnail,onUploaded:B},null,8,["bundle-id","initial-thumbnail"])]),e("div",_e,[e("div",we,[e("span",ke,d(s.id),1),e("h2",Be,d(s.title),1)]),e("table",Ce,[t[10]||(t[10]=e("thead",null,[e("tr",{class:"bg-gray-100"},[e("th",{class:"border border-gray-300 px-2 text-center"},"ID"),e("th",{class:"border border-gray-300 px-2 text-left"},"Course Title"),e("th",{class:"border border-gray-300 px-2 text-center w-32"},"Course Price"),e("th",{class:"border border-gray-300 px-2 text-center w-32"},"Bundle Price")])],-1)),e("tbody",null,[(a(!0),n(T,null,j(s.bundle_courses,f=>{var w,C;return a(),n("tr",{key:f.id},[e("td",$e,d(f.course_id),1),e("td",Me,[e("div",Te,d(((w=f.course)==null?void 0:w.title)||"-"),1)]),e("td",De,d(((C=f.course)==null?void 0:C.price)??"-"),1),e("td",je,d(f.course_price??"-"),1)])}),128))]),e("tfoot",null,[e("tr",Oe,[t[9]||(t[9]=e("td",{colspan:"2",class:"border border-gray-300 px-2 text-right"},"Total",-1)),e("td",Fe,d(s.bundle_courses.reduce((f,w)=>{var C;return f+Number(((C=w.course)==null?void 0:C.price)||0)},0)),1),e("td",Ne,d(s.bundle_courses.reduce((f,w)=>f+Number(w.course_price||0),0)),1)])])]),e("div",Ue,[e("div",Le,[x("",!0)]),e("div",ze,[e("button",{class:"btn-1 pb-1 pt-1.5 px-3",onClick:f=>v(s)},t[11]||(t[11]=[e("i",{class:"fas fa-eye"},null,-1),e("p",{class:"hidden md:flex"},"View",-1)]),8,Se),$(b,{to:{name:"BundleEditForm",params:{id:s.id}},class:"btn-1 pb-1 pt-1.5 px-3"},{default:O(()=>t[12]||(t[12]=[e("i",{class:"far fa-edit"},null,-1),e("p",{class:"hidden md:flex"},"Edit",-1)])),_:2},1032,["to"]),(a(),n("button",{key:0,class:"btn-contrast pb-2",onClick:f=>_(s)},t[13]||(t[13]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,Ve))])])])])):x("",!0)],64))),128))]))])),$(pe,{class:"absolute top-0 shadow-2xl w-full z-40",bundle:m.value,isOpen:l.value,onClose:t[1]||(t[1]=s=>l.value=!1)},null,8,["bundle","isOpen"]),$(Y,{class:"absolute top-0 shadow-2xl w-full z-40",bundle:m.value,isOpen:r.value,onClose:t[2]||(t[2]=s=>r.value=!1),onConfirmDelete:k},null,8,["bundle","isOpen"])])}}};export{He as default};
