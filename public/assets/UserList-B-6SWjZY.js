import{r as _,o as M,e as n,f as a,g as e,z as k,A as I,a5 as j,i as C,p as b,t as h,B as D,C as O,d as B,q as E,x as L,F as S,h as T,a8 as K,n as U,j as N}from"./index-DobcMGJW.js";import{u as z}from"./user-D5Az-tSi.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as q}from"./coupon-BwReyncE.js";const c=l=>(D("data-v-2d6467d1"),l=l(),O(),l),G={key:0,class:"modal"},H={class:"card-bg p-4 md:p-8 w-full max-w-xl space-y-2"},J=c(()=>e("h2",{class:"title-md text-center"},"Edit User",-1)),Q=c(()=>e("p",null,"Name",-1)),W=c(()=>e("p",null,"Phone",-1)),X=c(()=>e("p",null,"Photo URL",-1)),Y={class:"grid md:grid-cols-2 gap-4"},Z=c(()=>e("p",null,"Role",-1)),ee={key:0,value:"developer"},te=c(()=>e("option",{value:"admin"},"Admin",-1)),se=c(()=>e("option",{value:"instructor"},"Instructor",-1)),oe=c(()=>e("option",{value:"student"},"Student",-1)),le=c(()=>e("p",null,"Affiliate Status",-1)),ne=c(()=>e("option",{value:""},"- N/A -",-1)),ae=c(()=>e("option",{value:"Pending"},"Pending",-1)),ie=c(()=>e("option",{value:"Active"},"Active",-1)),de=c(()=>e("option",{value:"Inactive"},"Inactive",-1)),re=[ne,ae,ie,de],ue={key:0,class:"mt-4 text-red-600"},ce={__name:"EditUser",props:{user:Object,isOpen:Boolean},emits:["close","update"],setup(l,{emit:x}){const d=l,g=x,f=z(),r=_(""),i=_(""),m=_(""),t=_("student"),p=_(""),$=_(null);M(()=>{d.user&&(r.value=d.user.name,i.value=d.user.phone,m.value=d.user.photo,t.value=d.user.role,p.value=d.user.affiliate_status||"")});const w=async()=>{try{const y={name:r.value,phone:i.value,photo:m.value,role:t.value,affiliate_status:p.value};await f.updateUser(d.user.id,y),g("update",y),g("close")}catch(y){$.value=y.message}},A=()=>{g("close")};return(y,v)=>{var o,u;return l.isOpen?(n(),a("div",G,[e("div",H,[J,e("div",null,[Q,k(e("input",{class:"input-1","onUpdate:modelValue":v[0]||(v[0]=s=>r.value=s),placeholder:"Name"},null,512),[[I,r.value]])]),e("div",null,[W,k(e("input",{class:"input-1","onUpdate:modelValue":v[1]||(v[1]=s=>i.value=s),placeholder:"Phone"},null,512),[[I,i.value]])]),e("div",null,[X,k(e("input",{class:"input-1","onUpdate:modelValue":v[2]||(v[2]=s=>m.value=s),placeholder:"Photo URL"},null,512),[[I,m.value]])]),e("div",Y,[e("div",null,[Z,k(e("select",{class:"input-1","onUpdate:modelValue":v[3]||(v[3]=s=>t.value=s)},[((u=(o=C(f))==null?void 0:o.user)==null?void 0:u.role)==="developer"?(n(),a("option",ee,"Developer")):b("",!0),te,se,oe],512),[[j,t.value]])]),e("div",null,[le,k(e("select",{class:"input-1","onUpdate:modelValue":v[4]||(v[4]=s=>p.value=s)},re,512),[[j,p.value]])])]),e("div",{class:"flex justify-center gap-4 pt-4 border-t"},[e("button",{class:"btn-2",onClick:w},"Save"),e("button",{class:"btn-contrast",onClick:A},"Close")]),$.value?(n(),a("div",ue,h($.value),1)):b("",!0)])])):b("",!0)}}},pe=R(ce,[["__scopeId","data-v-2d6467d1"]]),F=l=>(D("data-v-15b6ee6c"),l=l(),O(),l),ve={class:"bg-white border rounded-lg w-full max-w-3xl p-4 max-h-[80vh]"},_e={class:"flex justify-between items-center gap-2"},he={class:"mb-0"},fe={class:"border px-3 pt-2 pb-1 rounded-lg"},me=F(()=>e("hr",{class:"my-3"},null,-1)),be={key:0},xe=F(()=>e("thead",null,[e("tr",null,[e("th",null,"Date"),e("th",null,"Course"),e("th",{class:"text-right"},"Amount")])],-1)),ge={class:"text-right"},ye={key:1,class:"flex justify-center items-center py-20 text-red-600"},$e={__name:"UserEarnListModal",props:{userId:String,onClose:Function},setup(l){const x=l;console.log(x);const d=q(),g=B(()=>{const f=d.userEarnings.reduce((r,i)=>r+parseInt(i.commission_amount),0);return parseInt(f)});return M(()=>{d.fetchUserEarnings({user_id:x.userId})}),(f,r)=>{var i,m;return n(),a("div",{onClick:r[1]||(r[1]=L((...t)=>l.onClose&&l.onClose(...t),["self"])),class:"fixed inset-0 w-full h-full flex justify-center pt-16 bg-black/40 z-[99999999]"},[e("div",ve,[e("div",_e,[e("h2",he,[E(" Earnings for UserID: "),e("b",fe,h(l.userId),1)]),e("i",{onClick:r[0]||(r[0]=L((...t)=>l.onClose&&l.onClose(...t),["self"])),class:"fal fa-window-close text-3xl cursor-pointer text-red-500"})]),me,(m=(i=C(d))==null?void 0:i.userEarnings)!=null&&m.length?(n(),a("div",be,[e("p",null,[E(" Total Earnings: "),e("strong",null,h(g.value)+" TK",1)]),e("table",null,[xe,e("tbody",null,[(n(!0),a(S,null,T(C(d).userEarnings,t=>{var p;return n(),a("tr",{key:t.id},[e("td",null,h(t.date),1),e("td",null,h((p=t==null?void 0:t.course)==null?void 0:p.title),1),e("td",null,[e("div",ge,h(parseInt(t.commission_amount))+" TK",1)])])}),128))])])])):(n(),a("div",ye," No earnings found for this promo code. "))])])}}},ke=R($e,[["__scopeId","data-v-15b6ee6c"]]);function V(l){return`https://ui-avatars.com/api/?name=${l}&length=1`}const Ue={class:"my-container p-4"},Ce=e("div",{class:"flex items-center justify-between"},[e("h1",{class:"text-2xl font-bold mb-4"},"User List")],-1),we={class:"flex items-center gap-2 mb-3"},Ae={class:"overflow-x-auto"},Ie={class:"min-w-full bg-white shadow-md rounded-lg overflow-hidden"},Se={class:"font-bold"},Me={class:"*:py-2 *:px-4 *:bg-gray-200 *:text-left *:text-sm *:text-gray-700 *:uppercase *:tracking-wider"},Pe=e("th",null,[e("div",{class:"text-center"},"User ID")],-1),je=e("th",null,"Photo",-1),Ee=e("th",null,"Name",-1),Le=e("th",null,"Phone",-1),Ne=e("th",null,"Role",-1),Ve={key:0},De=e("div",{class:"text-center"},"Affiliate",-1),Oe=[De],Be=e("th",null,[e("div",{class:"text-center"},"Actions")],-1),Te={key:0},ze=e("td",{class:"py-2 px-4 border-b border-gray-200 text-center",colspan:"6"},[e("div",{class:"flex justify-center items-center space-x-2"},[e("div",{class:"w-4 h-4 border-4 border-t-4 border-gray-200 rounded-full animate-spin"}),e("span",null,"Loading...")])],-1),Re=[ze],Fe={class:"text-center"},Ke=["src","onClick"],qe={class:"flex justify-center items-center gap-2"},Ge=["onClick"],He=["onClick"],Je={key:0},Qe=e("td",{class:"py-2 px-4 border-b border-gray-200",colspan:"6"},"No users found",-1),We=[Qe],Xe={key:0,class:"mt-4 text-red-600"},st={__name:"UserList",setup(l){const x=z(),d=K(),g=_(null),f=_(!1),r=_(!1),i=_(null),m=_(!0),t=_("Users");M(async()=>{try{await x.fetchUsers()}catch(o){g.value=o.message}finally{m.value=!1}});const p=B(()=>t.value==="Affiliate"?x.users.filter(o=>o==null?void 0:o.affiliate_status):t.value==="Admins"?x.users.filter(o=>(o==null?void 0:o.role)==="admin"):x.users),$=o=>{i.value=o,f.value=!0},w=o=>{i.value=o,r.value=!0},A=()=>{f.value=!1,i.value=null},y=o=>{const u=p.value.findIndex(s=>s.id===o.id);u!==-1&&(p.value[u]=o)},v=o=>{d.openPhotoModal("user",o.id,u=>o.photo=u,1),d.preview=o.photo??V(o.name)};return(o,u)=>(n(),a("div",Ue,[Ce,e("div",we,[e("button",{class:U(t.value==="Users"?"btn-2":"btn-1"),type:"button",onClick:u[0]||(u[0]=s=>t.value="Users")}," All Users ",2),e("button",{class:U(t.value==="Admins"?"btn-2":"btn-1"),type:"button",onClick:u[1]||(u[1]=s=>t.value="Admins")}," Admin Users ",2),e("button",{class:U(t.value==="Affiliate"?"btn-2":"btn-1"),type:"button",onClick:u[2]||(u[2]=s=>t.value="Affiliate")}," Affiliate Users ",2)]),e("div",Ae,[e("table",Ie,[e("thead",Se,[e("tr",Me,[Pe,je,Ee,Le,Ne,t.value==="Affiliate"?(n(),a("th",Ve,Oe)):b("",!0),Be])]),e("tbody",null,[m.value?(n(),a("tr",Te,Re)):(n(),a(S,{key:1},[(n(!0),a(S,null,T(p.value,s=>(n(),a("tr",{key:s.id,class:"hover:bg-gray-100 *:py-2 *:px-4 *:border-b *:border-gray-200"},[e("td",Fe,h(s.id),1),e("td",null,[e("img",{src:s.photo??C(V)(s.name),alt:"Photo",class:"size-10 rounded-full object-cover cursor-pointer",onClick:P=>v(s)},null,8,Ke)]),e("td",null,h(s.name),1),e("td",null,h(s.phone),1),e("td",null,h(s.role||"N/A"),1),t.value==="Affiliate"?(n(),a("td",{key:0,class:U(["text-center",s.affiliate_status==="Active"?"text-green-600":"text-red-600"])},h(s.affiliate_status),3)):b("",!0),e("td",null,[e("div",qe,[e("button",{class:"btn-2",onClick:P=>$(s)},"Edit",8,Ge),t.value==="Affiliate"?(n(),a("button",{key:0,class:"btn-1",onClick:P=>w(s)}," Earnings ",8,He)):b("",!0)])])]))),128)),p.value.length===0?(n(),a("tr",Je,We)):b("",!0)],64))])])]),g.value?(n(),a("div",Xe,h(g.value),1)):b("",!0),f.value&&i.value?(n(),N(pe,{key:1,user:i.value,isOpen:f.value,onClose:A,onUpdate:y},null,8,["user","isOpen"])):b("",!0),r.value?(n(),N(ke,{key:2,userId:`${i.value.id}`,onClose:()=>r.value=!1},null,8,["userId","onClose"])):b("",!0)]))}};export{st as default};
