import{D as T,E as b,r as h,d,e as u,f as t,m as E,p as q,v as N,t as f,q as v,H as M,I as S,w,b as U,o as W,s as H,y as k,z as I,h as D,F as G,g as J,i as j,x as L}from"./index-CoSo7CmJ.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const C=T("chapter",{state:()=>({chapters:[],error:null,loading:!1}),actions:{async index(s){var o,a;this.loading=!0,this.error=null;try{const e=await b.get(`/chapters?subject_id=${s}`);this.chapters=(e==null?void 0:e.data)??[]}catch(e){this.error=((a=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:a.message)??"An error occurred while fetching chapters"}finally{this.loading=!1}},async show(s){var o,a;this.error=null;try{const e=await b.get(`/chapters/${s}`);return(e==null?void 0:e.data)??null}catch(e){throw this.error=((a=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:a.message)??"An error occurred while fetching the chapter",e}},async store(s){var o,a;this.error=null;try{const e=await b.post("/chapters",s);this.chapters.push(e==null?void 0:e.data)}catch(e){throw this.error=((a=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:a.message)??"An error occurred while creating the chapter",e}},async update(s,o){var a,e;this.error=null;try{const n=await b.put(`/chapters/${s}`,o),c=this.chapters.findIndex(r=>r.id===s);c!==-1&&(this.chapters[c]=(n==null?void 0:n.data)??this.chapters[c])}catch(n){throw this.error=((e=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:e.message)??"An error occurred while updating the chapter",n}},async delete(s){var o,a;this.error=null;try{await b.delete(`/chapters/${s}`),this.chapters=this.chapters.filter(e=>e.id!==s)}catch(e){throw this.error=((a=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:a.message)??"An error occurred while deleting the chapter",e}}}}),V=s=>(M("data-v-3198cb5e"),s=s(),S(),s),K={class:"modal"},P={class:"modal-content space-y-2"},X=V(()=>t("h2",null,"Add Chapter",-1)),Y={key:0,class:"text-red-500"},Z={key:1,class:"text-red-500"},ee={class:"flex gap-4"},te=V(()=>t("button",{type:"submit",class:"btn-2"},"Add",-1)),se={__name:"AddChapterModal",props:{subjectId:{type:Number,required:!0}},emits:["close"],setup(s,{emit:o}){const a=o,e=s,n=C(),c=h(""),r=h({}),p=async()=>{r.value={};try{await n.store({name:c.value,subject_id:e.subjectId}),c.value="",a("close")}catch(i){i.response&&i.response.data&&i.response.data.errors&&(r.value=i.response.data.errors)}};return(i,l)=>(d(),u("div",K,[t("div",P,[X,t("form",{onSubmit:E(p,["prevent"]),class:"space-y-2"},[q(t("input",{class:"input-1","onUpdate:modelValue":l[0]||(l[0]=_=>c.value=_),placeholder:"Chapter name",required:""},null,512),[[N,c.value]]),r.value.name?(d(),u("div",Y,f(r.value.name[0]),1)):v("",!0),r.value.subject_id?(d(),u("div",Z,f(r.value.subject_id[0]),1)):v("",!0),t("div",ee,[te,t("button",{type:"button",onClick:l[1]||(l[1]=_=>a("close")),class:"btn-contrast"},"Cancel")])],32)])]))}},ae=A(se,[["__scopeId","data-v-3198cb5e"]]),oe=s=>(M("data-v-bfd49cca"),s=s(),S(),s),ce={key:0,class:"modal"},re={class:"modal-content space-y-2"},ne=oe(()=>t("h2",null,"Delete Chapter",-1)),le={key:0,class:"text-red-500"},de={class:"flex gap-4"},ie={__name:"DeleteChapterModal",props:{chapter:{type:Object,required:!0,default:()=>({name:"",id:null})}},emits:["close"],setup(s,{emit:o}){const a=o,e=s,n=C(),c=h({});w(()=>e.chapter,p=>{},{immediate:!0});const r=async()=>{c.value={};try{await n.delete(e.chapter.id),a("close")}catch(p){p.response&&p.response.data&&p.response.data.errors&&(c.value=p.response.data.errors)}};return(p,i)=>e.chapter&&e.chapter.name?(d(),u("div",ce,[t("div",re,[ne,t("p",null,"Are you sure you want to delete the chapter: "+f(e.chapter.name)+"?",1),c.value.subject_id?(d(),u("div",le,f(c.value.subject_id[0]),1)):v("",!0),t("div",de,[t("button",{onClick:r,class:"btn-2"},"Delete"),t("button",{type:"button",onClick:i[0]||(i[0]=l=>a("close")),class:"btn-contrast"},"Cancel")])])])):v("",!0)}},ue=A(ie,[["__scopeId","data-v-bfd49cca"]]),Q=s=>(M("data-v-a74a6de1"),s=s(),S(),s),pe={class:"modal"},he={class:"modal-content space-y-2"},_e=Q(()=>t("h2",null,"Edit Chapter",-1)),ve={key:0,class:"text-red-500"},me={key:1,class:"text-red-500"},fe={class:"flex gap-4"},ye=Q(()=>t("button",{type:"submit",class:"btn-2"},"Save",-1)),be={__name:"EditChapterModal",props:{chapter:{type:Object,required:!0}},emits:["close"],setup(s,{emit:o}){var i;const a=o,e=s,n=C(),c=h(((i=e.chapter)==null?void 0:i.name)||""),r=h({});w(()=>e.chapter,l=>{l&&(c.value=l.name)},{immediate:!0});const p=async()=>{r.value={};try{await n.update(e.chapter.id,{name:c.value,subject_id:e.chapter.subject_id}),a("close")}catch(l){l.response&&l.response.data&&l.response.data.errors&&(r.value=l.response.data.errors)}};return(l,_)=>(d(),u("div",pe,[t("div",he,[_e,t("form",{onSubmit:E(p,["prevent"]),class:"space-y-2"},[q(t("input",{class:"input-1","onUpdate:modelValue":_[0]||(_[0]=g=>c.value=g),placeholder:"Chapter name",required:""},null,512),[[N,c.value]]),r.value.name?(d(),u("div",ve,f(r.value.name[0]),1)):v("",!0),r.value.subject_id?(d(),u("div",me,f(r.value.subject_id[0]),1)):v("",!0),t("div",fe,[ye,t("button",{type:"button",onClick:_[1]||(_[1]=g=>a("close")),class:"btn-contrast"},"Cancel")])],32)])]))}},ge=A(be,[["__scopeId","data-v-a74a6de1"]]),we={class:"my-container space-y-2"},Ce={class:"flex justify-between"},xe={class:"flex items-center gap-4"},$e=t("i",{class:"fas fa-arrow-left"},null,-1),ke=t("h4",{class:"title-lg"},"Chapter List",-1),Ie={key:0,class:"flex justify-center items-center"},je=t("div",{class:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-gray-900"},null,-1),Me=[je],Se={key:1},Ae={key:0,class:"grid md:grid-cols-3 gap-4"},De={class:"flex flex-col items-center"},Le=t("i",{class:"fad fa-folder text-4xl"},null,-1),Ee={class:"title-md"},qe={class:"absolute top-4 right-4 flex gap-2"},Ne=["onClick"],Ve=t("i",{class:"fad fa-edit"},null,-1),Qe=[Ve],ze=["onClick"],Be=t("i",{class:"fad fa-trash"},null,-1),Re=[Be],Fe={class:"flex justify-center items-center w-full flex-wrap gap-x-8 gap-y-2"},Oe={key:1,class:"text-red-500"},He={__name:"ChapterList",setup(s){const o=U(),a=h(o.params.categoryId),e=h(o.params.id),n=C(),c=h(!1),r=h(!1),p=h(!1),i=h(null),l=h(!0),_=()=>c.value=!0,g=()=>c.value=!1,z=m=>{i.value=m,r.value=!0},B=()=>r.value=!1,R=m=>{i.value=m,p.value=!0},F=()=>p.value=!1,x=async()=>{try{l.value=!0,await n.index(e.value)}finally{l.value=!1}};return W(x),w(()=>o.params.id,async m=>{e.value=m,await x()}),w(()=>o.params.categoryId,async m=>{a.value=m,await x()}),(m,Te)=>{const $=H("RouterLink");return d(),u("div",we,[t("div",Ce,[t("div",xe,[k($,{class:"btn-3",to:{name:"SubjectList",params:{id:a.value}}},{default:I(()=>[$e]),_:1},8,["to"]),ke]),t("button",{class:"btn-2",onClick:_},"Add Chapter")]),l.value?(d(),u("div",Ie,Me)):(d(),u("div",Se,[D(n).chapters.length?(d(),u("div",Ae,[(d(!0),u(G,null,J(D(n).chapters,y=>(d(),u("div",{key:y.id,class:"relative card-bg items-center p-4"},[t("div",De,[Le,t("p",Ee,f(y.name),1)]),t("div",qe,[t("button",{onClick:O=>z(y)},Qe,8,Ne),t("button",{onClick:O=>R(y),class:"text-red-500"},Re,8,ze)]),t("div",Fe,[k($,{to:{name:"McqQuestionList",params:{categoryId:a.value,subjectId:e.value,chapterId:y.id}},class:"btn-link"},{default:I(()=>[L(" MCQ Questions ")]),_:2},1032,["to"]),k($,{to:{name:"WrittenQuestionList",params:{categoryId:a.value,subjectId:e.value,chapterId:y.id}},class:"btn-link"},{default:I(()=>[L(" Written Questions ")]),_:2},1032,["to"])])]))),128))])):(d(),u("p",Oe,"No chapters found"))])),c.value?(d(),j(ae,{key:2,class:"z-40",subjectId:e.value,onClose:g},null,8,["subjectId"])):v("",!0),r.value?(d(),j(ge,{key:3,class:"z-40",chapter:i.value,onClose:B},null,8,["chapter"])):v("",!0),p.value?(d(),j(ue,{key:4,class:"z-40",chapter:i.value,onClose:F},null,8,["chapter"])):v("",!0)])}}};export{He as default};
