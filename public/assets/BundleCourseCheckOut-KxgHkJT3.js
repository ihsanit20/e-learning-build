import{P as j,r as v,I as F,Q as w,x as s,z as t,A as d,B as m,C as n,D as B,X as y,L as S,Z as R,F as D,U as L,ab as M,T as V,y as l}from"./vue-CAqJJQzZ.js";import{_ as K}from"./bkash_payment_logo-S19rnIIS.js";import{d as A,e as I}from"./index-_BXdcGLR.js";import{u as U}from"./purchase-DJfqUYif.js";import"./vendor-PJuFQbji.js";const E={class:"max-w-4xl mx-auto py-4"},$={key:0,class:"space-y-4"},q={key:0,class:"text-center text-green-600 bg-green-600/20 p-4 rounded font-bold text-xl md:text-2xl"},z={class:"grid gap-4 md:grid-cols-2"},G={class:"card-bg p-4 space-y-2"},O={class:"space-y-2"},Q={class:"flex justify-between"},X={class:"flex justify-between"},Y={class:"flex justify-between font-bold"},Z={key:0,class:"flex justify-center items-center flex-col gap-4"},H={class:"text-orange-500 text-center"},J={key:1,class:"space-y-4"},W={key:0,class:"border-black"},ee={key:1,class:"error text-rose-600"},te={class:"mt-2"},se={class:"flex justify-center items-center space-x-4"},le={class:"flex justify-center items-center"},oe={key:3,class:"mt-2 text-red-600 font-bold text-center text-xl"},ne={key:1,class:"flex justify-center items-center p-4"},me={__name:"BundleCourseCheckOut",setup(ae){const b=j(),N=V(),f=b.query.message,_=A(),p=U(),h=b.params.bundleId,a=v(null),r=v(null),i=v("bkash_payment");F(async()=>{try{await _.fetchBundle(h),a.value=_.bundle}catch(o){r.value=o.message||"Failed to fetch bundle"}});const P=async()=>{var o;try{if(i.value==="bkash_payment"){const e=await p.createBundlePayment(h);console.log("Bkash payment response:",e),window.location=(o=e==null?void 0:e.data)==null?void 0:o.bkashURL}else i.value==="bank_transfer"&&(alert("Bank Transfer selected. Checkout completed successfully!"),N.push("/my/bundle"))}catch(e){r.value=e.message||"Failed to initiate payment",console.error("Error during checkout:",r.value)}},x=w(()=>a.value.bundle_courses.reduce((o,e)=>{var c;return o+Number(((c=e.course)==null?void 0:c.price)||0)},0)),u=w(()=>a.value.bundle_courses.reduce((o,e)=>o+Number(e.course_price||0),0));return(o,e)=>{var k,g,C;const c=R("RouterLink");return l(),s("div",E,[a.value?(l(),s("div",$,[e[13]||(e[13]=t("h1",{class:"title-xl text-center"},"Checkout Page",-1)),m(f)?(l(),s("div",q,n(m(f)),1)):d("",!0),t("div",z,[t("div",null,[B(I,{bundle:a.value,showSlotButton:!1},null,8,["bundle"])]),t("div",null,[t("div",G,[e[12]||(e[12]=t("h4",{class:"title-lg text-center"},"Payment Details",-1)),t("div",O,[t("div",Q,[e[1]||(e[1]=t("p",null,"Course Fee",-1)),t("p",null,n(x.value)+" TK",1)]),t("div",X,[e[2]||(e[2]=t("p",null,"Bundle Discount",-1)),t("p",null,n(x.value-u.value)+" TK",1)]),e[4]||(e[4]=t("hr",null,null,-1)),t("div",Y,[e[3]||(e[3]=t("p",null,"Total",-1)),t("p",null,n(u.value)+" TK",1)])]),(k=a.value.purchased_course_ids)!=null&&k.length?(l(),s("div",Z,[e[7]||(e[7]=t("hr",{class:"w-full border-black"},null,-1)),t("p",H,[e[5]||(e[5]=y(" You have already purchased ")),t("b",null,n((g=a.value.purchased_course_ids)==null?void 0:g.length),1),y(" course"+n(((C=a.value.purchased_course_ids)==null?void 0:C.length)>1?"s":"")+' from this bundle. Check the "My Courses" page for detail. ',1)]),B(c,{to:"/my/course",class:"btn-2"},{default:S(()=>e[6]||(e[6]=[y(" Go to My Course ")])),_:1})])):(l(),s("div",J,[r.value?(l(),s("hr",W)):d("",!0),r.value?(l(),s("div",ee,n(r.value),1)):d("",!0),e[10]||(e[10]=t("hr",{class:"border-black"},null,-1)),u.value>0?(l(),s(D,{key:2},[e[9]||(e[9]=t("p",{class:"title-lg text-center"},"Select payment method",-1)),t("div",te,[t("label",se,[L(t("input",{type:"radio","onUpdate:modelValue":e[0]||(e[0]=T=>i.value=T),value:"bkash_payment"},null,512),[[M,i.value]]),e[8]||(e[8]=t("span",null,[t("img",{class:"w-52",src:K,alt:"Bkash Payment"})],-1))])])],64)):d("",!0),e[11]||(e[11]=t("hr",{class:"border-black"},null,-1)),t("div",le,[t("button",{class:"btn-2",onClick:P},n(u.value>0?`Pay Now (${Number(u.value).toFixed()} TK)`:"Checkout (Fee)"),1)]),m(p).error?(l(),s("div",oe,n(m(p).error),1)):d("",!0)]))])])])])):(l(),s("div",ne,"Loading..."))])}}};export{me as default};
