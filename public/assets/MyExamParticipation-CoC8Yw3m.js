import{E as H,r as m,G as M,b as U,c as z,J as A,o as R,d as S,e as o,f as n,i as y,F as g,g as s,t as w,q as B,H as j,h as T,z as k,I as E,n as D,x as F,A as N}from"./index-C6JPkN7d.js";const P=H("courseExam",()=>{const r=m({}),b=m({}),l=m(!1);async function p(i,d){var a,c;l.value=!0;try{const e=await M.get(`/my-courses/${i}/exams/${d}`);r.value=(e==null?void 0:e.data)??{}}catch(e){e.value=((c=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:c.message)??"An error occurred"}return l.value=!1,r.value}async function _(i,d){var a,c;l.value=!0;try{const e=await M.post(`/my-courses/${i}/exams/${d}`,{user_given_answers:r.value.questions});r.value=(e==null?void 0:e.data)??{}}catch(e){e.value=((c=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:c.message)??"An error occurred"}return l.value=!1,r.value}return{exam:r,error:b,loading:l,fetchExam:p,submitExam:_}}),Q={class:"my-container"},G={key:0,class:"card-bg p-4 md:p-8"},J=s("p",null,"Loading...",-1),W=[J],q={class:"shrink-0 grow-0 card-bg p-4 sticky top-0"},K={class:"flex justify-between items-center gap-2"},O={class:"line-clamp-1"},X={class:"grow-0 shrink-0 border px-3 pt-2 pb-1 rounded-lg"},Y=s("span",{class:"hidden md:inline"},"Remaining:",-1),Z={class:"relative w-full h-2 bg-gray-300 rounded mt-1"},ee={class:"shrink grow mt-6 space-y-4 overflow-hidden overflow-y-auto scrollbar"},se={class:"mb-2"},te={class:"font-semibold"},ae=["innerHTML"],oe={key:0,class:"space-y-2"},ne=["name","id","value","onUpdate:modelValue"],re=["for","innerHTML"],le={key:1},ie=["onUpdate:modelValue"],ce=s("hr",{class:"my-5"},null,-1),ue={class:"flex items-center gap-1 md:gap-2"},de=s("span",{class:"pt-1 text-xs md:text-base"},"I want to submit",-1),me=s("br",null,null,-1),_e={__name:"MyExamParticipation",setup(r){const b=U(),l=z(),p=P(),_=m(!1),{courseId:i,examId:d}=b.params,{exam:a,loading:c}=A(p),e=m(0),f=m(0);R(async()=>{await p.fetchExam(i,d),a.value.duration&&(f.value=a.value.duration*60,e.value=f.value,L())});function L(){const v=setInterval(()=>{e.value>0?e.value-=1:(clearInterval(v),$())},1e3)}const V=S(()=>{const v=Math.floor(e.value/60),h=Math.floor(v/60),t=v%60,x=e.value%60;return`${h?`${h}:`:""}${String(t).padStart(2,"0")}:${String(x).padStart(2,"0")}`}),I=S(()=>(f.value-e.value)/f.value*100),$=async()=>(await p.submitExam(i,d),l.replace({path:`/my/course/${i}`}));return(v,h)=>(o(),n("div",Q,[y(c)?(o(),n("div",G,W)):(o(),n(g,{key:1},[s("div",q,[s("div",K,[s("h3",O,w(y(a).title),1),s("p",X,[Y,B(),s("b",null,w(V.value),1)])]),s("div",Z,[s("div",{class:"absolute left-0 top-0 h-full bg-blue-500 rounded",style:j({width:`${I.value}%`})},null,4)])]),s("div",ee,[(o(!0),n(g,null,T(y(a).questions,(t,x)=>(o(),n("div",{key:t.id,class:"card-bg p-4"},[s("div",se,[s("h4",te,"Question "+w(x+1)+":",1),s("div",{innerHTML:t.question_text},null,8,ae)]),t.type==="MCQ"?(o(),n("div",oe,[(o(!0),n(g,null,T(t.mcq_options,u=>(o(),n("div",{key:u.id,class:"flex items-center cursor-pointer border px-3 py-4 rounded-lg"},[k(s("input",{type:"checkbox",name:"question-"+x,id:`question:${t.id}-option:${u.id}`,value:u.id,class:"mr-2 size-4 cursor-pointer","onUpdate:modelValue":C=>t.user_answers=C},null,8,ne),[[E,t.user_answers]]),s("label",{class:"cursor-pointer",for:`question:${t.id}-option:${u.id}`,innerHTML:u.option_text},null,8,re)]))),128))])):(o(),n("div",le,[k(s("textarea",{class:"w-full p-2 border rounded-md",rows:"4",placeholder:"Write your answer here...","onUpdate:modelValue":u=>t.user_answers[0]=u},null,8,ie),[[N,t.user_answers[0]]])]))]))),128))]),ce,s("form",{onSubmit:F($,["prevent"]),class:"grow-0 shrink-0 w-full flex justify-end gap-1 md:gap-4"},[s("label",ue,[k(s("input",{"onUpdate:modelValue":h[0]||(h[0]=t=>_.value=t),type:"checkbox",required:""},null,512),[[E,_.value]]),de]),s("button",{type:"submit",class:D(["btn-2 disabled:opacity-50 px-1 md:px-4 text-xs md:text-base",{"opacity-50":!_.value}])}," Submit Answer ",2)],32),me],64))]))}};export{_e as default};
